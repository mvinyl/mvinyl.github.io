{"version":3,"sources":["webgl.js","util.js","space-3d.js","skybox.js","app.js","index.js"],"names":["GLBuffer","gl","this","initialize","buffer","createBuffer","bind","bindBuffer","ARRAY_BUFFER","set","data","bufferData","STATIC_DRAW","module","exports","buildAttribs","layout","attribs","key","size","getExtensions","extArray","ext","i","length","e","getExtension","Error","Framebuffer","color","depth","fb","createFramebuffer","drawBuffers","push","drawBuffersWEBGL","framebufferTexture2D","FRAMEBUFFER","TEXTURE_2D","texture","COLOR_ATTACHMENT0","undefined","DEPTH_ATTACHMENT","bindFramebuffer","Texture","index","width","height","options","target","mag","NEAREST","min","wraps","CLAMP_TO_EDGE","wrapt","internalFormat","RGBA","format","type","UNSIGNED_BYTE","activate","createTexture","texImage2D","texParameteri","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","TEXTURE_WRAP_T","generateMipmap","bindTexture","activeTexture","TEXTURE0","reset","Renderable","program","buffers","primitiveCount","render","name","use","location","console","log","enableVertexAttribArray","vertexAttribPointer","FLOAT","drawArrays","TRIANGLES","disableVertexAttribArray","attributes","InstancedRenderable","instancedExt","vertexAttribDivisorANGLE","divisor","drawArraysInstancedANGLE","Program","vertexSource","fragmentSource","compileProgram","gatherAttribs","uniforms","gatherUniforms","useProgram","vertexShader","compileShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","source","shader","createShader","shaderSource","getShaderParameter","COMPILE_STATUS","err","getShaderInfoLog","lineno","parseInt","split","q","warn","typeString","setUniform","value","args","Array","prototype","slice","call","arguments","apply","concat","nUniforms","ACTIVE_UNIFORMS","uniform","getActiveUniform","getUniformLocation","nAttribs","ACTIVE_ATTRIBUTES","attrib","getActiveAttrib","getAttribLocation","webgl","require","loadProgram","replace","glm","util","rng","buildStar","pos","dist","rand","b","c","Math","pow","random","vertices","position","ii","rot","a","theta","acos","vec3","dot","omega","create","cross","normalize","quat","setAxisAngle","quatRotBetweenVecs","fromValues","transformQuat","buildBox","aPosition","Float32Array","count","randomRotation","mat4","rotateX","PI","rotateY","rotateZ","randomVec3","v","transformMat4","hashcode","str","hash","charCodeAt","init","canvas","document","createElement","getContext","enable","BLEND","blendFuncSeparate","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","ZERO","ONE","nebula","pointStars","star","sun","toString","pNebula","pPointStars","pStar","pSun","MT","aColor","rPointStars","rNebula","rSun","rStar","params","textures","resolution","viewport","seed","pStarParams","rotation","starParams","stars","falloff","nebulaParams","nebulae","scale","intensity","offset","sunParams","dirs","front","up","back","left","right","top","bottom","model","view","projection","perspective","keys","Object","clearColor","clear","COLOR_BUFFER_BIT","dir","lookAt","j","ps","mul","s","p","drawImage","renderCanvas","pixelStorei","UNPACK_FLIP_Y_WEBGL","skybox","pSkybox","rSkybox","aUV","buildQuad","setTextures","canvases","LINEAR_MIPMAP_LINEAR","LINEAR","Space3D","Skybox","fov","getElementById","window","innerWidth","innerHeight","space","tick","App","props","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","renderSpace","assertThisInitialized","renderTextures","style","display","unifiedTexture","ctx","drawIndividual","targetId","hideUnified","hideSplit","cos","sin","requestAnimationFrame","react_default","className","href","rel","React","Component","ReactDOM","src_app"],"mappings":"0EA+GA,SAASA,EAASC,GAChBC,KAAKC,WAAa,WAChBD,KAAKE,OAASH,EAAGI,gBAGnBH,KAAKI,KAAO,WACVL,EAAGM,WAAWN,EAAGO,aAAcN,KAAKE,SAGtCF,KAAKO,IAAM,SAAUC,GACnBR,KAAKI,OACLL,EAAGU,WAAWV,EAAGO,aAAcE,EAAMT,EAAGW,cAG1CV,KAAKC,aAlHPU,EAAOC,QAAQC,aAXf,SAAsBd,EAAIe,GACxB,IAAIC,EAAU,GAEd,IAAK,IAAIC,KAAOF,EACdC,EAAQC,GAAO,CACbd,OAAQ,IAAIJ,EAASC,GACrBkB,KAAMH,EAAOE,IAGjB,OAAOD,GAkBTJ,EAAOC,QAAQM,cAZf,SAAuBnB,EAAIoB,GAGzB,IAFA,IAAIC,EAAM,GAEDC,EAAI,EAAGA,EAAIF,EAASG,OAAQD,IAAK,CACxC,IAAIE,EAAIxB,EAAGyB,aAAaL,EAASE,IACjC,GAAU,OAANE,EACF,MAAME,MAAM,aAAeN,EAASE,GAAK,kBAE3CD,EAAID,EAASE,IAAME,EAErB,OAAOH,GAmCTT,EAAOC,QAAQc,YA7Bf,SAAqB3B,EAAI4B,EAAOC,EAAOR,GACrCpB,KAAKC,WAAa,WAGhB,GAFAD,KAAK6B,GAAK9B,EAAG+B,oBACb9B,KAAKI,OACDuB,EAAML,OAAS,EAAG,CAEpB,IADA,IAAIS,EAAc,GACTV,EAAI,EAAGA,EAAIM,EAAML,OAAQD,IAChCU,EAAYC,KAAKZ,EAAI,mBAAqBC,EAAI,WAGhD,IADAD,EAAIa,iBAAiBF,GAChBV,EAAI,EAAGA,EAAIM,EAAML,OAAQD,IAC5BtB,EAAGmC,qBAAqBnC,EAAGoC,YAAaf,EAAI,mBAAqBC,EAAI,UACnEtB,EAAGqC,WAAYT,EAAMN,GAAGgB,QAAS,QAGrCtC,EAAGmC,qBAAqBnC,EAAGoC,YAAapC,EAAGuC,kBAAmBvC,EAAGqC,WAAYT,EAAM,GAAGU,QAAS,QAGnFE,IAAVX,GACF7B,EAAGmC,qBAAqBnC,EAAGoC,YAAapC,EAAGyC,iBAAkBzC,EAAGqC,WAAYR,EAAMS,QAAS,IAI/FrC,KAAKI,KAAO,WACVL,EAAG0C,gBAAgB1C,EAAGoC,YAAanC,KAAK6B,KAG1C7B,KAAKC,cAiDPU,EAAOC,QAAQ8B,QA3Cf,SAAiB3C,EAAI4C,EAAOnC,EAAMoC,EAAOC,EAAQC,IAC/CA,EAAUA,GAAW,IACbC,OAASD,EAAQC,QAAUhD,EAAGqC,WACtCU,EAAQE,IAAMF,EAAQE,KAAOjD,EAAGkD,QAChCH,EAAQI,IAAMJ,EAAQI,KAAOnD,EAAGkD,QAChCH,EAAQK,MAAQL,EAAQK,OAASpD,EAAGqD,cACpCN,EAAQO,MAAQP,EAAQO,OAAStD,EAAGqD,cACpCN,EAAQQ,eAAiBR,EAAQQ,gBAAkBvD,EAAGwD,KACtDT,EAAQU,OAASV,EAAQU,QAAUzD,EAAGwD,KACtCT,EAAQW,KAAOX,EAAQW,MAAQ1D,EAAG2D,cAElC1D,KAAKC,WAAa,WAChBD,KAAK2C,MAAQA,EACb3C,KAAK2D,WACL3D,KAAKqC,QAAUtC,EAAG6D,gBAClB5D,KAAKI,OACLL,EAAG8D,WAAWf,EAAQC,OAAQ,EAAGD,EAAQQ,eAAgBR,EAAQU,OAAQV,EAAQW,KAAMjD,GACvFT,EAAG+D,cAAchB,EAAQC,OAAQhD,EAAGgE,mBAAoBjB,EAAQE,KAChEjD,EAAG+D,cAAchB,EAAQC,OAAQhD,EAAGiE,mBAAoBlB,EAAQI,KAChEnD,EAAG+D,cAAchB,EAAQC,OAAQhD,EAAGkE,eAAgBnB,EAAQK,OAC5DpD,EAAG+D,cAAchB,EAAQC,OAAQhD,EAAGmE,eAAgBpB,EAAQO,OACxDP,EAAQE,MAAQjD,EAAGkD,SAAWH,EAAQI,MAAQnD,EAAGkD,SACnDlD,EAAGoE,eAAerB,EAAQC,SAI9B/C,KAAKI,KAAO,WACVL,EAAGqE,YAAYtB,EAAQC,OAAQ/C,KAAKqC,UAGtCrC,KAAK2D,SAAW,WACd5D,EAAGsE,cAActE,EAAGuE,SAAWtE,KAAK2C,QAGtC3C,KAAKuE,MAAQ,WACXvE,KAAK2D,WACL3D,KAAKI,OACLL,EAAG8D,WAAWf,EAAQC,OAAQ,EAAGD,EAAQQ,eAAgBV,EAAOC,EAC9D,EAAGC,EAAQU,OAAQV,EAAQW,KAAMjD,IAGrCR,KAAKC,cAsBPU,EAAOC,QAAQd,SAAWA,EA+B1Ba,EAAOC,QAAQ4D,WA3Bf,SAAoBzE,EAAI0E,EAASC,EAASC,GACxC3E,KAAK2E,eAAiBA,EACtB3E,KAAKC,WAAa,aAElBD,KAAK4E,OAAS,WAEZ,IAAK,IAAIC,KADTJ,EAAQK,MACSJ,EAAS,CACxB,IAAIxE,EAASwE,EAAQG,GAAM3E,OACvBe,EAAOyD,EAAQG,GAAM5D,KACzB,IACE,IAAI8D,EAAWN,EAAQ1D,QAAQ8D,GAAME,SACrC,MAAOxD,GAEP,MADAyD,QAAQC,IAAI,8BAA+BJ,GACrCtD,EAERrB,EAAOE,OACPL,EAAGmF,wBAAwBH,GAC3BhF,EAAGoF,oBAAoBJ,EAAU9D,EAAMlB,EAAGqF,OAAO,EAAO,EAAG,GAG7D,IAAKP,KADL9E,EAAGsF,WAAWtF,EAAGuF,UAAW,EAAG,EAAIX,GACtB3E,KAAK0E,QAChB3E,EAAGwF,yBAAyBd,EAAQe,WAAWX,GAAME,WAIzD/E,KAAKC,cAiCPU,EAAOC,QAAQ6E,oBA3Bf,SAA6B1F,EAAI0E,EAASC,EAASC,EAAgBe,GACjE1F,KAAKC,WAAa,aAElBD,KAAK4E,OAAS,WAEZ,IAAK,IAAIC,KADTJ,EAAQK,MACSJ,EAAS,CACxB,IAAIxE,EAASwE,EAAQG,GAAM3E,OACvBe,EAAOyD,EAAQG,GAAM5D,KACzB,IACE,IAAI8D,EAAWN,EAAQ1D,QAAQ8D,GAAME,SACrC,MAAOxD,GAEP,MADAyD,QAAQC,IAAI,8BAA+BJ,GACrCtD,EAERrB,EAAOE,OACPL,EAAGmF,wBAAwBH,GAC3BhF,EAAGoF,oBAAoBJ,EAAU9D,EAAMlB,EAAGqF,OAAO,EAAO,EAAG,GAC3DM,EAAaC,yBAAyBZ,EAAUL,EAAQG,GAAMe,SAGhE,IAAKf,KADLa,EAAaG,yBAAyB9F,EAAGuF,UAAW,EAAG,GAAWX,GACrD3E,KAAK0E,QAChB3E,EAAGwF,yBAAyBd,EAAQe,WAAWX,GAAME,WAIzD/E,KAAKC,cAgGPU,EAAOC,QAAQkF,QA1Ff,SAAiB/F,EAAIgG,EAAcC,GACjChG,KAAKC,WAAa,WAChBD,KAAKyE,QAAUzE,KAAKiG,eAAeF,EAAcC,GACjDhG,KAAKe,QAAUf,KAAKkG,gBACpBlG,KAAKmG,SAAWnG,KAAKoG,kBAGvBpG,KAAK8E,IAAM,WACT/E,EAAGsG,WAAWrG,KAAKyE,UAGrBzE,KAAKiG,eAAiB,SAAUF,EAAcC,GAC5C,IAAIM,EAAetG,KAAKuG,cAAcR,EAAchG,EAAGyG,eACnDC,EAAiBzG,KAAKuG,cAAcP,EAAgBjG,EAAG2G,iBACvDjC,EAAU1E,EAAG4G,gBAIjB,GAHA5G,EAAG6G,aAAanC,EAAS6B,GACzBvG,EAAG6G,aAAanC,EAASgC,GACzB1G,EAAG8G,YAAYpC,IACV1E,EAAG+G,oBAAoBrC,EAAS1E,EAAGgH,aAEtC,MADA/B,QAAQC,IAAIlF,EAAGiH,kBAAkBvC,IAC3B,IAAIhD,MAAM,8BAElB,OAAOgD,GAGTzE,KAAKuG,cAAgB,SAAUU,EAAQxD,GACrC,IAAIyD,EAASnH,EAAGoH,aAAa1D,GAG7B,GAFA1D,EAAGqH,aAAaF,EAAQD,GACxBlH,EAAGwG,cAAcW,IACZnH,EAAGsH,mBAAmBH,EAAQnH,EAAGuH,gBAAiB,CACrD,IAAIC,EAAMxH,EAAGyH,iBAAiBN,GAC1BO,EAASC,SAASH,EAAII,MAAM,KAAK,IACjCA,EAAQV,EAAOU,MAAM,MACzB,IAAK,IAAItG,KAAKsG,EAAO,CACnB,IAAIC,EAAIF,SAASrG,GACjB2D,QAAQC,IAAI2C,EAAI,KAAOD,EAAMtG,IACzBA,IAAMoG,EAAS,GACjBzC,QAAQ6C,KAAKN,GAGjB,IAAIO,EAAarE,IAAS1D,EAAGyG,cAAgB,SAAW,WACxD,MAAM/E,MAAM,qBAAuBqG,EAAa,YAElD,OAAOZ,GAGTlH,KAAK+H,WAAa,SAAUlD,EAAMpB,EAAMuE,GACtC,IAAIC,EAAOC,MAAMC,UAAUC,MAAMC,KAAKC,UAAW,GACjDtI,KAAK8E,MACL,IACE,IAAIC,EAAW/E,KAAKmG,SAAStB,GAAME,SAErC,MAAOxD,GAEL,MADAyD,QAAQC,IAAIJ,GACNtD,EAERxB,EAAG,UAAY0D,GAAM8E,MAAMxI,EAAI,CAACgF,GAAUyD,OAAOP,KAGnDjI,KAAKoG,eAAiB,WAGpB,IAFA,IAAID,EAAW,GACXsC,EAAY1I,EAAG+G,oBAAoB9G,KAAKyE,QAAS1E,EAAG2I,iBAC/CrH,EAAI,EAAGA,EAAIoH,EAAWpH,IAAK,CAClC,IAAIsH,EAAU5I,EAAG6I,iBAAiB5I,KAAKyE,QAASpD,GAChD8E,EAASwC,EAAQ9D,MAAQ,CACvBA,KAAM8D,EAAQ9D,KACdE,SAAUhF,EAAG8I,mBAAmB7I,KAAKyE,QAASkE,EAAQ9D,MACtDpB,KAAMkF,EAAQlF,KACdxC,KAAM0H,EAAQ1H,MAGlB,OAAOkF,GAGTnG,KAAKkG,cAAgB,WAGnB,IAFA,IAAInF,EAAU,GACV+H,EAAW/I,EAAG+G,oBAAoB9G,KAAKyE,QAAS1E,EAAGgJ,mBAC9C1H,EAAI,EAAGA,EAAIyH,EAAUzH,IAAK,CACjC,IAAI2H,EAASjJ,EAAGkJ,gBAAgBjJ,KAAKyE,QAASpD,GAC9CN,EAAQiI,EAAOnE,MAAQ,CACrBA,KAAMmE,EAAOnE,KACbE,SAAUhF,EAAGmJ,kBAAkBlJ,KAAKyE,QAASuE,EAAOnE,MACpDpB,KAAMuF,EAAOvF,KACbxC,KAAM+H,EAAO/H,MAGjB,OAAOF,GAETf,KAAKC,iCCzRP,IAAIkJ,EAAQC,EAAQ,GAGpBzI,EAAOC,QAAQyI,YAAc,SAAUtJ,EAAIkH,GAkTzC,OAFAA,GADAA,EAASA,EAAOqC,QAAQ,cA9Sb,+nXA+SK3B,MAAM,aACR,IAAIwB,EAAMrD,QAAQ/F,EAAIkH,EAAO,GAAIA,EAAO,sGCpTxD,IAAIsC,EAAMH,EAAQ,GACdD,EAAQC,EAAQ,GAChBI,EAAOJ,EAAQ,GACfK,EAAML,EAAQ,GAsXlB,SAASM,EAAUzI,EAAM0I,EAAKC,EAAMC,GAsBlC,IArBA,IAoG0BC,EApGtBC,EAAIC,KAAKC,IAAIJ,EAAKK,SAAU,GAC5BvI,EAAQ,CACVoI,EAAGA,EAAGA,EACNA,EAAGA,EAAGA,EACNA,EAAGA,EAAGA,EACNA,EAAGA,EAAGA,EACNA,EAAGA,EAAGA,EACNA,EAAGA,EAAGA,GAGJI,EAAW,CACb,EAAElJ,GAAOA,EAAM,GACf,CAACA,GAAOA,EAAM,GACd,CAACA,EAAMA,EAAM,GACb,EAAEA,GAAOA,EAAM,GACf,CAACA,EAAMA,EAAM,GACb,EAAEA,EAAMA,EAAM,IAGZmJ,EAAW,GAENC,EAAK,EAAGA,EAAK,EAAGA,IAAM,CAC7B,IAAIC,GA8EoBR,EA9EKH,EAmEjC,SAA4BY,EAAGT,GAC7B,IAAIU,EAAQR,KAAKS,KAAKlB,EAAImB,KAAKC,IAAIJ,EAAGT,IAClCc,EAAQrB,EAAImB,KAAKG,SACrBtB,EAAImB,KAAKI,MAAMF,EAAOL,EAAGT,GACzBP,EAAImB,KAAKK,UAAUH,EAAOA,GAC1B,IAAIN,EAAMf,EAAIyB,KAAKH,SAEnB,OADAtB,EAAIyB,KAAKC,aAAaX,EAAKM,EAAOJ,GAC3BF,EAKAY,CAAmB3B,EAAImB,KAAKS,WAAW,EAAG,GAAI,GAAIrB,IA9EvDP,EAAImB,KAAKU,cAAcjB,EAASE,GAAKF,EAASE,GAAKC,GACnDH,EAASE,GAAI,IAAMV,EAAI,GAAKC,EAC5BO,EAASE,GAAI,IAAMV,EAAI,GAAKC,EAC5BO,EAASE,GAAI,IAAMV,EAAI,GAAKC,EAC5BQ,EAASpI,KAAKuG,MAAM6B,EAAUD,EAASE,IAGzC,MAAO,CACLD,SAAUA,EACVzI,MAAOA,GAKX,SAAS0J,EAAStL,EAAI0E,GACpB,IAAI2F,EAAW,EACZ,GAAI,GAAI,EACT,GAAI,GAAI,EACR,EAAG,GAAI,GACN,GAAI,GAAI,EACT,EAAG,GAAI,GACN,EAAG,GAAI,EAER,GAAI,EAAG,GACN,GAAI,EAAG,GACP,EAAG,EAAG,EACP,GAAI,EAAG,GACN,EAAG,EAAG,EACP,EAAG,EAAG,EAEN,GAAI,GAAI,EACR,GAAI,EAAG,EACP,EAAG,EAAG,EACN,GAAI,GAAI,EACR,EAAG,EAAG,EACN,EAAG,GAAI,GAEN,GAAI,EAAG,GACP,GAAI,GAAI,GACR,EAAG,GAAI,GACP,GAAI,EAAG,GACP,EAAG,GAAI,GACP,EAAG,EAAG,GAEN,EAAG,GAAI,EACR,EAAG,GAAI,EACP,EAAG,EAAG,GACL,EAAG,GAAI,EACR,EAAG,EAAG,GACL,EAAG,EAAG,GAEN,GAAI,EAAG,EACR,GAAI,EAAG,EACP,GAAI,GAAI,GACP,GAAI,EAAG,EACR,GAAI,GAAI,GACP,GAAI,GAAI,GAEPrJ,EAAUoI,EAAMtI,aAAad,EAAI,CAAEuL,UAAW,IAClDvK,EAAQuK,UAAUpL,OAAOK,IAAI,IAAIgL,aAAanB,IAC9C,IAAIoB,EAAQpB,EAAS9I,OAAS,EAE9B,OADiB,IAAI6H,EAAM3E,WAAWzE,EAAI0E,EAAS1D,EAASyK,GAqB9D,SAASC,EAAe5B,GACtB,IAAIS,EAAMf,EAAImC,KAAKb,SAInB,OAHAtB,EAAImC,KAAKC,QAAQrB,EAAKA,EAAKT,EAAKK,SAAWF,KAAK4B,GAAK,GACrDrC,EAAImC,KAAKG,QAAQvB,EAAKA,EAAKT,EAAKK,SAAWF,KAAK4B,GAAK,GACrDrC,EAAImC,KAAKI,QAAQxB,EAAKA,EAAKT,EAAKK,SAAWF,KAAK4B,GAAK,GAC9CtB,EAIT,SAASyB,EAAWlC,GAClB,IAAImC,EAAI,CAAC,EAAG,EAAG,GACX1B,EAAMmB,EAAe5B,GAGzB,OAFAN,EAAImB,KAAKuB,cAAcD,EAAGA,EAAG1B,GAC7Bf,EAAImB,KAAKK,UAAUiB,EAAGA,GACfA,EAIT,SAASE,EAASC,GAEhB,IADA,IAAIC,EAAO,EACF/K,EAAI,EAAGA,EAAI8K,EAAI7K,OAAQD,IAAK,CAEnC+K,IAAS/K,EAAI,GADF8K,EAAIE,WAAWhL,GAG5B,OAAO+K,EAnfTzL,EAAOC,QAAU,WACfZ,KAAKsM,KAAO,WAEVtM,KAAKuM,OAASC,SAASC,cAAc,UAGrCzM,KAAKD,GAAKC,KAAKuM,OAAOG,WAAW,SACjC1M,KAAKD,GAAG4M,OAAO3M,KAAKD,GAAG6M,OACvB5M,KAAKD,GAAG8M,kBAAkB7M,KAAKD,GAAG+M,UAAW9M,KAAKD,GAAGgN,oBAAqB/M,KAAKD,GAAGiN,KAAMhN,KAAKD,GAAGkN,KAGhG,IAAIC,EAAM,m0CAyDNC,EAAU,siBA8BVC,EAAI,00BAoCJC,EAAG,i4BAqCPH,EAASA,EAAOI,SAAS,SACzBH,EAAaA,EAAWG,SAAS,SACjCF,EAAOA,EAAKE,SAAS,SACrBD,EAAMA,EAAIC,SAAS,SACnBtN,KAAKuN,QAAU/D,EAAKH,YAAYrJ,KAAKD,GAAImN,GACzClN,KAAKwN,YAAchE,EAAKH,YAAYrJ,KAAKD,GAAIoN,GAC7CnN,KAAKyN,MAAQjE,EAAKH,YAAYrJ,KAAKD,GAAIqN,GACvCpN,KAAK0N,KAAOlE,EAAKH,YAAYrJ,KAAKD,GAAIsN,GAMtC,IAHA,IAAIxD,EAAO,IAAIJ,EAAIkE,GAAGzB,EAAS,kBAAoB,KAC/C9B,EAAW,IAAImB,aAAa,MAC5B5J,EAAQ,IAAI4J,aAAa,MACpBlK,EAAI,EAAGA,EA3LP,IA2LmBA,IAAK,CAG/B+L,EAAO1D,EAFI,IACDH,EAAImB,KAAKR,OAAOX,EAAImB,KAAKG,SAAU,GACjB,IAAOhB,GACnCO,EAAS7J,IAAI6M,EAAKhD,SAAc,GAAJ/I,GAC5BM,EAAMpB,IAAI6M,EAAKzL,MAAW,GAAJN,GAExB,IAAIN,EAAUoI,EAAMtI,aAAab,KAAKD,GAAI,CAAEuL,UAAW,EAAGsC,OAAQ,IAClE7M,EAAQuK,UAAUpL,OAAOK,IAAI6J,GAC7BrJ,EAAQ6M,OAAO1N,OAAOK,IAAIoB,GAC1B,IAAI6J,EAAQpB,EAAS9I,OAAS,EAC9BtB,KAAK6N,YAAc,IAAI1E,EAAM3E,WAAWxE,KAAKD,GAAIC,KAAKwN,YAAazM,EAASyK,GAG5ExL,KAAK8N,QAAUzC,EAASrL,KAAKD,GAAIC,KAAKuN,SACtCvN,KAAK+N,KAAO1C,EAASrL,KAAKD,GAAIC,KAAK0N,MACnC1N,KAAKgO,MAAQ3C,EAASrL,KAAKD,GAAIC,KAAKyN,QAGtCzN,KAAK4E,OAAS,SAAUqJ,GAEtB,IAAIC,EAAW,GAGflO,KAAKuM,OAAO3J,MAAQ5C,KAAKuM,OAAO1J,OAASoL,EAAOE,WAChDnO,KAAKD,GAAGqO,SAAS,EAAG,EAAGH,EAAOE,WAAYF,EAAOE,YAKjD,IAFA,IAAItE,EAAO,IAAIJ,EAAIkE,GAAGzB,EAAS+B,EAAOI,MAAQ,KAC1CC,EAAc,GACXL,EAAOd,aACZmB,EAAYtM,KAAK,CACfuM,SAAU9C,EAAe5B,OAEvBA,EAAKK,SAAW,OAKtBL,EAAO,IAAIJ,EAAIkE,GAAGzB,EAAS+B,EAAOI,MAAQ,KAE1C,IADA,IAAIG,EAAa,GACVP,EAAOQ,QACZD,EAAWxM,KAAK,CACd2H,IAAKoC,EAAWlC,GAChBlI,MAAO,CAAC,EAAG,EAAG,GACdV,KAAM,EACNyN,QAAS7E,EAAKK,SAAWF,KAAKC,IAAI,EAAG,IAAMD,KAAKC,IAAI,EAAG,QAErDJ,EAAKK,SAAW,QAKtBL,EAAO,IAAIJ,EAAIkE,GAAGzB,EAAS+B,EAAOI,MAAQ,KAE1C,IADA,IAAIM,EAAe,GACZV,EAAOW,UACZD,EAAa3M,KAAK,CAChB6M,MAAuB,GAAhBhF,EAAKK,SAAiB,IAC7BvI,MAAO,CAACkI,EAAKK,SAAUL,EAAKK,SAAUL,EAAKK,UAC3C4E,UAA2B,GAAhBjF,EAAKK,SAAiB,GACjCwE,QAAyB,EAAhB7E,EAAKK,SAAiB,EAC/B6E,OAAQ,CAAiB,IAAhBlF,EAAKK,SAAkB,IAAsB,IAAhBL,EAAKK,SAAkB,IAAsB,IAAhBL,EAAKK,SAAkB,SAExFL,EAAKK,SAAW,OAKtBL,EAAO,IAAIJ,EAAIkE,GAAGzB,EAAS+B,EAAOI,MAAQ,KAC1C,IAAIW,EAAY,GACZf,EAAOZ,KACT2B,EAAUhN,KAAK,CACb2H,IAAKoC,EAAWlC,GAChBlI,MAAO,CAACkI,EAAKK,SAAUL,EAAKK,SAAUL,EAAKK,UAC3CjJ,KAAsB,KAAhB4I,EAAKK,SAAoB,KAC/BwE,QAAyB,GAAhB7E,EAAKK,SAAkB,IAIpC,IAAI+E,EAAO,CACTC,MAAO,CACLnM,OAAQ,CAAC,EAAG,GAAI,GAChBoM,GAAI,CAAC,EAAG,EAAG,IAEbC,KAAM,CACJrM,OAAQ,CAAC,EAAG,EAAG,GACfoM,GAAI,CAAC,EAAG,EAAG,IAEbE,KAAM,CACJtM,OAAQ,EAAE,EAAG,EAAG,GAChBoM,GAAI,CAAC,EAAG,EAAG,IAEbG,MAAO,CACLvM,OAAQ,CAAC,EAAG,EAAG,GACfoM,GAAI,CAAC,EAAG,EAAG,IAEbI,IAAK,CACHxM,OAAQ,CAAC,EAAG,EAAG,GACfoM,GAAI,CAAC,EAAG,EAAG,IAEbK,OAAQ,CACNzM,OAAQ,CAAC,GAAI,EAAG,GAChBoM,GAAI,CAAC,EAAG,GAAI,KAKZM,EAAQlG,EAAImC,KAAKb,SACjB6E,EAAOnG,EAAImC,KAAKb,SAChB8E,EAAapG,EAAImC,KAAKb,SAC1BtB,EAAImC,KAAKkE,YAAYD,EAAY3F,KAAK4B,GAAK,EAAG,EAAK,GAAK,KAGxD,IADA,IAAIiE,EAAOC,OAAOD,KAAKZ,GACd5N,EAAI,EAAGA,EAAIwO,EAAKvO,OAAQD,IAAK,CAEpCrB,KAAKD,GAAGgQ,WAAW,EAAG,EAAG,EAAG,GAC5B/P,KAAKD,GAAGiQ,MAAMhQ,KAAKD,GAAGkQ,kBAEtB,IAAIC,EAAMjB,EAAKY,EAAKxO,IACpBkI,EAAImC,KAAKyE,OAAOT,EAAM,CAAC,EAAG,EAAG,GAAIQ,EAAInN,OAAQmN,EAAIf,IAEjDnP,KAAKwN,YAAY1I,MACjB2K,EAAQlG,EAAImC,KAAKb,SACjB7K,KAAKwN,YAAYzF,WAAW,QAAS,aAAa,EAAO2H,GACzD1P,KAAKwN,YAAYzF,WAAW,cAAe,aAAa,EAAO4H,GAC/D,IAAK,IAAIS,EAAI,EAAGA,EAAI9B,EAAYhN,OAAQ8O,IAAK,CAC3C,IAAIC,EAAK/B,EAAY8B,GACrB7G,EAAImC,KAAK4E,IAAIb,EAAOY,EAAG9B,SAAUkB,GACjCzP,KAAKwN,YAAYzF,WAAW,SAAU,aAAa,EAAO0H,GAC1DzP,KAAK6N,YAAYjJ,SAOnB,IAJA5E,KAAKyN,MAAM3I,MACX9E,KAAKyN,MAAM1F,WAAW,QAAS,aAAa,EAAO2H,GACnD1P,KAAKyN,MAAM1F,WAAW,cAAe,aAAa,EAAO4H,GACzD3P,KAAKyN,MAAM1F,WAAW,SAAU,aAAa,EAAO0H,GAC/CW,EAAI,EAAGA,EAAI5B,EAAWlN,OAAQ8O,IAAK,CACtC,IAAIG,EAAI/B,EAAW4B,GACnBpQ,KAAKyN,MAAM1F,WAAW,YAAa,MAAOwI,EAAE5G,KAC5C3J,KAAKyN,MAAM1F,WAAW,SAAU,MAAOwI,EAAE5O,OACzC3B,KAAKyN,MAAM1F,WAAW,QAAS,KAAMwI,EAAEtP,MACvCjB,KAAKyN,MAAM1F,WAAW,WAAY,KAAMwI,EAAE7B,SAC1C1O,KAAKgO,MAAMpJ,SAKb,IAFA5E,KAAKuN,QAAQzI,MACb2K,EAAQlG,EAAImC,KAAKb,SACZuF,EAAI,EAAGA,EAAIzB,EAAarN,OAAQ8O,IAAK,CACxC,IAAII,EAAI7B,EAAayB,GACrBpQ,KAAKuN,QAAQxF,WAAW,SAAU,aAAa,EAAO0H,GACtDzP,KAAKuN,QAAQxF,WAAW,QAAS,aAAa,EAAO2H,GACrD1P,KAAKuN,QAAQxF,WAAW,cAAe,aAAa,EAAO4H,GAC3D3P,KAAKuN,QAAQxF,WAAW,SAAU,KAAMyI,EAAE3B,OAC1C7O,KAAKuN,QAAQxF,WAAW,SAAU,MAAOyI,EAAE7O,OAC3C3B,KAAKuN,QAAQxF,WAAW,aAAc,KAAMyI,EAAE1B,WAC9C9O,KAAKuN,QAAQxF,WAAW,WAAY,KAAMyI,EAAE9B,SAC5C1O,KAAKuN,QAAQxF,WAAW,UAAW,MAAOyI,EAAEzB,QAC5C/O,KAAK8N,QAAQlJ,SAOf,IAJA5E,KAAK0N,KAAK5I,MACV9E,KAAK0N,KAAK3F,WAAW,QAAS,aAAa,EAAO2H,GAClD1P,KAAK0N,KAAK3F,WAAW,cAAe,aAAa,EAAO4H,GACxD3P,KAAK0N,KAAK3F,WAAW,SAAU,aAAa,EAAO0H,GAC9CW,EAAI,EAAGA,EAAIpB,EAAU1N,OAAQ8O,IAAK,CACrC,IAAI/C,EAAM2B,EAAUoB,GACpBpQ,KAAK0N,KAAK3F,WAAW,YAAa,MAAOsF,EAAI1D,KAC7C3J,KAAK0N,KAAK3F,WAAW,SAAU,MAAOsF,EAAI1L,OAC1C3B,KAAK0N,KAAK3F,WAAW,QAAS,KAAMsF,EAAIpM,MACxCjB,KAAK0N,KAAK3F,WAAW,WAAY,KAAMsF,EAAIqB,SAC3C1O,KAAK+N,KAAKnJ,SAGZ,IAAImF,EAAIyC,SAASC,cAAc,UAC/B1C,EAAEnH,MAAQmH,EAAElH,OAASoL,EAAOE,WAClBpE,EAAE2C,WAAW,MACnB+D,UAAUzQ,KAAKuM,OAAQ,EAAG,GAC9B2B,EAAS2B,EAAKxO,IAAM0I,EAEtB,OAAOmE,GAETlO,KAAKsM,4BCrXP,IAAI/C,EAAMH,EAAQ,GACdD,EAAQC,EAAQ,GAChBI,EAAOJ,EAAQ,GAGnBzI,EAAOC,QAAU,SAAU8P,GACzB1Q,KAAKsM,KAAO,WACVtM,KAAKD,GAAK2Q,EAAahE,WAAW,SAClC1M,KAAKD,GAAG4Q,YAAY3Q,KAAKD,GAAG6Q,qBAAqB,GACjD,IAAIC,EAAM,+jBA+BVA,EAASA,EAAOvD,SAAS,SACzBtN,KAAK8Q,QAAUtH,EAAKH,YAAYrJ,KAAKD,GAAI8Q,GACzC7Q,KAAK+Q,QA0DT,SAAmBhR,EAAI0E,GACrB,IAAI2F,EAAW,EACZ,GAAI,GAAI,EACT,GAAI,GAAI,EACR,EAAG,GAAI,GACN,GAAI,GAAI,EACT,EAAG,GAAI,GACN,EAAG,GAAI,GAUNrJ,EAAUoI,EAAMtI,aAAad,EAAI,CAAEuL,UAAW,EAAG0F,IAAK,IAC1DjQ,EAAQuK,UAAUpL,OAAOK,IAAI,IAAIgL,aAAanB,IAC9CrJ,EAAQiQ,IAAI9Q,OAAOK,IAAI,IAAIgL,aAVlB,CACP,EAAG,EACH,EAAG,EACH,EAAG,EACH,EAAG,EACH,EAAG,EACH,EAAG,KAKL,IAAIC,EAAQpB,EAAS9I,OAAS,EAE9B,OADiB,IAAI6H,EAAM3E,WAAWzE,EAAI0E,EAAS1D,EAASyK,GA/E3CyF,CAAUjR,KAAKD,GAAIC,KAAK8Q,SACvC9Q,KAAKkO,SAAW,IAGlBlO,KAAKkR,YAAc,SAAUC,GAC3BnR,KAAKkO,SAAW,GAEhB,IADA,IAAI2B,EAAOC,OAAOD,KAAKsB,GACd9P,EAAI,EAAGA,EAAIwO,EAAKvO,OAAQD,IAAK,CACpC,IAAI0I,EAAIoH,EAAStB,EAAKxO,IACtBrB,KAAKkO,SAAS2B,EAAKxO,IAAM,IAAI8H,EAAMzG,QAAQ1C,KAAKD,GAAI,EAAGgK,EAAGA,EAAEnH,MAAOmH,EAAElH,OAAQ,CAC3EK,IAAKlD,KAAKD,GAAGqR,qBACbpO,IAAKhD,KAAKD,GAAGsR,WAKnBrR,KAAK4E,OAAS,SAAU8K,EAAMC,GAC5B3P,KAAKD,GAAGqO,SAAS,EAAG,EAAGsC,EAAa9N,MAAO8N,EAAa7N,QAExD,IAAI4M,EAAQlG,EAAImC,KAAKb,SAErB7K,KAAK8Q,QAAQhM,MACb9E,KAAK8Q,QAAQ/I,WAAW,QAAS,aAAa,EAAO2H,GACrD1P,KAAK8Q,QAAQ/I,WAAW,cAAe,aAAa,EAAO4H,GAE3D3P,KAAKkO,SAASgB,MAAM9O,OACpBJ,KAAK8Q,QAAQ/I,WAAW,SAAU,aAAa,EAAO0H,GACtDzP,KAAK+Q,QAAQnM,SAEb5E,KAAKkO,SAASkB,KAAKhP,OACnBmJ,EAAImC,KAAKG,QAAQ4D,EAAOlG,EAAImC,KAAKb,SAAUb,KAAK4B,IAChD5L,KAAK8Q,QAAQ/I,WAAW,SAAU,aAAa,EAAO0H,GACtDzP,KAAK+Q,QAAQnM,SAEb5E,KAAKkO,SAASmB,KAAKjP,OACnBmJ,EAAImC,KAAKG,QAAQ4D,EAAOlG,EAAImC,KAAKb,SAAUb,KAAK4B,GAAK,GACrD5L,KAAK8Q,QAAQ/I,WAAW,SAAU,aAAa,EAAO0H,GACtDzP,KAAK+Q,QAAQnM,SAEb5E,KAAKkO,SAASoB,MAAMlP,OACpBmJ,EAAImC,KAAKG,QAAQ4D,EAAOlG,EAAImC,KAAKb,UAAWb,KAAK4B,GAAK,GACtD5L,KAAK8Q,QAAQ/I,WAAW,SAAU,aAAa,EAAO0H,GACtDzP,KAAK+Q,QAAQnM,SAEb5E,KAAKkO,SAASqB,IAAInP,OAClBmJ,EAAImC,KAAKC,QAAQ8D,EAAOlG,EAAImC,KAAKb,SAAUb,KAAK4B,GAAK,GACrD5L,KAAK8Q,QAAQ/I,WAAW,SAAU,aAAa,EAAO0H,GACtDzP,KAAK+Q,QAAQnM,SAEb5E,KAAKkO,SAASsB,OAAOpP,OACrBmJ,EAAImC,KAAKC,QAAQ8D,EAAOlG,EAAImC,KAAKb,UAAWb,KAAK4B,GAAK,GACtD5L,KAAK8Q,QAAQ/I,WAAW,SAAU,aAAa,EAAO0H,GACtDzP,KAAK+Q,QAAQnM,UAEf5E,KAAKsM,sICzFH/C,SAAMH,EAAQ,IACdkI,EAAUlI,EAAQ,IAClBmI,EAASnI,EAAQ,IAGjBoI,EAAM,GACVA,EAAOA,EAAM,IAAOxH,KAAK4B,GAAK,EAC9B,IACIyC,GAAwB,KAAhBrE,KAAKE,UAAgCoD,SAAS,IAItDa,EAAa,KAGbuC,EAAelE,SAASiF,eAAe,iBAC3Cf,EAAa9N,MAAQ8O,OAAOC,WAC5BjB,EAAa7N,OAAS6O,OAAOE,YAC7B,IAAIf,EAAS,IAAIU,EAAOb,GACpBmB,EAAQ,IAAIP,EAAQnD,GACpB2D,EAAO,EA0GIC,cAtGb,SAAAA,EAAYC,GAAO,IAAAC,EAAA,OAAAnC,OAAAoC,EAAA,EAAApC,CAAA9P,KAAA+R,IACjBE,EAAAnC,OAAAqC,EAAA,EAAArC,CAAA9P,KAAA8P,OAAAsC,EAAA,EAAAtC,CAAAiC,GAAA1J,KAAArI,KAAMgS,KAEDK,YAAcJ,EAAKI,YAAYjS,KAAjB0P,OAAAwC,EAAA,EAAAxC,CAAAmC,IAEnBA,EAAKM,iBACLN,EAAKI,cANYJ,6EAUjBzF,SAASiF,eAAe,kBAAkBe,MAAMC,QAAU,2CAI1DjG,SAASiF,eAAe,gBAAgBe,MAAMC,QAAU,OACxDjG,SAASiF,eAAe,iBAAiBe,MAAMC,QAAU,OACzDjG,SAASiF,eAAe,eAAee,MAAMC,QAAU,OACvDjG,SAASiF,eAAe,kBAAkBe,MAAMC,QAAU,OAC1DjG,SAASiF,eAAe,iBAAiBe,MAAMC,QAAU,OACzDjG,SAASiF,eAAe,gBAAgBe,MAAMC,QAAU,gDAIxD,IAAIvE,EAAW2D,EAAMjN,OAAO,CAC1ByJ,KAAMA,EACNlB,YA1CW,EA2CXsB,OAzCM,EA0CNpB,KAzCI,EA0CJuB,SAzCQ,EA0CR8D,gBAvCe,EAwCfvE,WAAYA,IAEd0C,EAAOK,YAAYhD,GACnB,IAAI3B,EAASC,SAASiF,eAAe,kBACrClF,EAAO3J,MAAQ,EAAIuL,EACnB5B,EAAO1J,OAAS,EAAIsL,EACpB,IAAIwE,EAAMpG,EAAOG,WAAW,MAQ5B,SAASkG,EAAe3L,EAAQ4L,GAC9B,IAAItG,EAASC,SAASiF,eAAeoB,GACrCtG,EAAO3J,MAAQ2J,EAAO1J,OAASsL,EACrB5B,EAAOG,WAAW,MACxB+D,UAAUxJ,EAAQ,EAAG,GAX3B0L,EAAIlC,UAAUvC,EAASmB,KAAmB,EAAblB,EAA6B,EAAbA,GAC7CwE,EAAIlC,UAAUvC,EAASoB,MAAoB,EAAbnB,EAA6B,EAAbA,GAC9CwE,EAAIlC,UAAUvC,EAASgB,MAAoB,EAAbf,EAA6B,EAAbA,GAC9CwE,EAAIlC,UAAUvC,EAASkB,KAAmB,EAAbjB,EAA6B,EAAbA,GAC7CwE,EAAIlC,UAAUvC,EAASqB,IAAkB,EAAbpB,EAA6B,EAAbA,GAC5CwE,EAAIlC,UAAUvC,EAASsB,OAAqB,EAAbrB,EAA6B,EAAbA,GAS/CyE,EAAe1E,EAASmB,KAAM,gBAC9BuD,EAAe1E,EAASoB,MAAO,iBAC/BsD,EAAe1E,EAASgB,MAAO,iBAC/B0D,EAAe1E,EAASkB,KAAM,gBAC9BwD,EAAe1E,EAASqB,IAAK,eAC7BqD,EAAe1E,EAASsB,OAAQ,wDAIhCxP,KAAK8S,cACL9S,KAAK+S,YAELjB,GAAQ,OAGR,IAAIpC,EAAOnG,EAAImC,KAAKb,SAChB8E,EAAapG,EAAImC,KAAKb,SAE1B6F,EAAa9N,MAAQ8O,OAAOC,WAC5BjB,EAAa7N,OAAS6O,OAAOE,YAE7BrI,EAAImC,KAAKyE,OAAOT,EAAM,CAAC,EAAG,EAAG,GAAI,CAAC1F,KAAKgJ,IAAIlB,GAAO9H,KAAKiJ,IAAW,KAAPnB,GAAe9H,KAAKiJ,IAAInB,IAAQ,CAAC,EAAG,EAAG,IAElGvI,EAAImC,KAAKkE,YAAYD,EAAY6B,EAAKd,EAAa9N,MAAQ8N,EAAa7N,OAAQ,GAAK,GAErFgO,EAAOjM,OAAO8K,EAAMC,GAEpBuD,sBAAsBlT,KAAKqS,8CAS3B,OACEc,EAAA5I,EAAAkC,cAAA,OAAK2G,UAAU,OACbD,EAAA5I,EAAAkC,cAAA,OAAK2G,UAAU,eACbD,EAAA5I,EAAAkC,cAAA,oBACA0G,EAAA5I,EAAAkC,cAAA,OAAK2G,UAAU,WAGjBD,EAAA5I,EAAAkC,cAAA,OAAK2G,UAAU,kBACbD,EAAA5I,EAAAkC,cAAA,KAAG2G,UAAU,SAASC,KAAK,iCAAiCtQ,OAAO,SAASuQ,IAAI,uBAAhF,qBAhGQC,IAAMC,WCzBxBC,IAAS7O,OAAOuO,EAAA5I,EAAAkC,cAACiH,EAAD,MAASlH,SAASiF,eAAe","file":"static/js/main.0fe7d2e8.chunk.js","sourcesContent":["function buildAttribs(gl, layout) {\r\n  var attribs = {};\r\n\r\n  for (var key in layout) {\r\n    attribs[key] = {\r\n      buffer: new GLBuffer(gl),\r\n      size: layout[key]\r\n    }\r\n  }\r\n  return attribs;\r\n}\r\nmodule.exports.buildAttribs = buildAttribs;\r\n\r\n\r\n// ****\r\nfunction getExtensions(gl, extArray) {\r\n  var ext = {};\r\n\r\n  for (var i = 0; i < extArray.length; i++) {\r\n    var e = gl.getExtension(extArray[i]);\r\n    if (e === null) {\r\n      throw Error('Extension ' + extArray[i] + 'not available.');\r\n    }\r\n    ext[extArray[i]] = e;\r\n  }\r\n  return ext;\r\n}\r\nmodule.exports.getExtensions = getExtensions;\r\n\r\n\r\n// ****\r\nfunction Framebuffer(gl, color, depth, ext) {\r\n  this.initialize = function () {\r\n    this.fb = gl.createFramebuffer();\r\n    this.bind();\r\n    if (color.length > 1) {\r\n      var drawBuffers = [];\r\n      for (var i = 0; i < color.length; i++) {\r\n        drawBuffers.push(ext['COLOR_ATTACHMENT' + i + '_WEBGL']);\r\n      }\r\n      ext.drawBuffersWEBGL(drawBuffers);\r\n      for (i = 0; i < color.length; i++) {\r\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, ext['COLOR_ATTACHMENT' + i + '_WEBGL'],\r\n          gl.TEXTURE_2D, color[i].texture, 0);\r\n      }\r\n    } else {\r\n      gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, color[0].texture, 0);\r\n    }\r\n\r\n    if (depth !== undefined) {\r\n      gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.TEXTURE_2D, depth.texture, 0);\r\n    }\r\n  };\r\n\r\n  this.bind = function () {\r\n    gl.bindFramebuffer(gl.FRAMEBUFFER, this.fb);\r\n  }\r\n\r\n  this.initialize();\r\n}\r\nmodule.exports.Framebuffer = Framebuffer;\r\n\r\n\r\n// ****\r\nfunction Texture(gl, index, data, width, height, options) {\r\n  options = options || {};\r\n  options.target = options.target || gl.TEXTURE_2D;\r\n  options.mag = options.mag || gl.NEAREST;\r\n  options.min = options.min || gl.NEAREST;\r\n  options.wraps = options.wraps || gl.CLAMP_TO_EDGE;\r\n  options.wrapt = options.wrapt || gl.CLAMP_TO_EDGE;\r\n  options.internalFormat = options.internalFormat || gl.RGBA;\r\n  options.format = options.format || gl.RGBA;\r\n  options.type = options.type || gl.UNSIGNED_BYTE;\r\n\r\n  this.initialize = function () {\r\n    this.index = index;\r\n    this.activate();\r\n    this.texture = gl.createTexture();\r\n    this.bind();\r\n    gl.texImage2D(options.target, 0, options.internalFormat, options.format, options.type, data);\r\n    gl.texParameteri(options.target, gl.TEXTURE_MAG_FILTER, options.mag);\r\n    gl.texParameteri(options.target, gl.TEXTURE_MIN_FILTER, options.min);\r\n    gl.texParameteri(options.target, gl.TEXTURE_WRAP_S, options.wraps);\r\n    gl.texParameteri(options.target, gl.TEXTURE_WRAP_T, options.wrapt);\r\n    if (options.mag !== gl.NEAREST || options.min !== gl.NEAREST) {\r\n      gl.generateMipmap(options.target);\r\n    }\r\n  }\r\n\r\n  this.bind = function () {\r\n    gl.bindTexture(options.target, this.texture);\r\n  };\r\n\r\n  this.activate = function () {\r\n    gl.activeTexture(gl.TEXTURE0 + this.index);\r\n  };\r\n\r\n  this.reset = function () {\r\n    this.activate();\r\n    this.bind();\r\n    gl.texImage2D(options.target, 0, options.internalFormat, width, height,\r\n      0, options.format, options.type, data);\r\n  }\r\n\r\n  this.initialize();\r\n}\r\nmodule.exports.Texture = Texture;\r\n\r\n\r\n// ****\r\nfunction GLBuffer(gl) {\r\n  this.initialize = function () {\r\n    this.buffer = gl.createBuffer();\r\n  }\r\n\r\n  this.bind = function () {\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.buffer);\r\n  }\r\n\r\n  this.set = function (data) {\r\n    this.bind();\r\n    gl.bufferData(gl.ARRAY_BUFFER, data, gl.STATIC_DRAW);\r\n  }\r\n\r\n  this.initialize();\r\n};\r\nmodule.exports.GLBuffer = GLBuffer;\r\n\r\n\r\n// ****\r\nfunction Renderable(gl, program, buffers, primitiveCount) {\r\n  this.primitiveCount = primitiveCount;\r\n  this.initialize = function () { }\r\n\r\n  this.render = function () {\r\n    program.use();\r\n    for (var name in buffers) {\r\n      var buffer = buffers[name].buffer;\r\n      var size = buffers[name].size;\r\n      try {\r\n        var location = program.attribs[name].location;\r\n      } catch (e) {\r\n        console.log('Could not find location for', name);\r\n        throw e;\r\n      }\r\n      buffer.bind();\r\n      gl.enableVertexAttribArray(location);\r\n      gl.vertexAttribPointer(location, size, gl.FLOAT, false, 0, 0);\r\n    }\r\n    gl.drawArrays(gl.TRIANGLES, 0, 3 * primitiveCount);\r\n    for (name in this.buffers) {\r\n      gl.disableVertexAttribArray(program.attributes[name].location);\r\n    }\r\n  }\r\n\r\n  this.initialize();\r\n};\r\nmodule.exports.Renderable = Renderable;\r\n\r\n\r\n// ****\r\nfunction InstancedRenderable(gl, program, buffers, primitiveCount, instancedExt) {\r\n  this.initialize = function () { }\r\n\r\n  this.render = function () {\r\n    program.use();\r\n    for (var name in buffers) {\r\n      var buffer = buffers[name].buffer;\r\n      var size = buffers[name].size;\r\n      try {\r\n        var location = program.attribs[name].location;\r\n      } catch (e) {\r\n        console.log('Could not find location for', name);\r\n        throw e;\r\n      }\r\n      buffer.bind();\r\n      gl.enableVertexAttribArray(location);\r\n      gl.vertexAttribPointer(location, size, gl.FLOAT, false, 0, 0);\r\n      instancedExt.vertexAttribDivisorANGLE(location, buffers[name].divisor);\r\n    }\r\n    instancedExt.drawArraysInstancedANGLE(gl.TRIANGLES, 0, 6 * 2 * 3, primitiveCount)\r\n    for (name in this.buffers) {\r\n      gl.disableVertexAttribArray(program.attributes[name].location);\r\n    }\r\n  }\r\n\r\n  this.initialize();\r\n};\r\nmodule.exports.InstancedRenderable = InstancedRenderable;\r\n\r\n\r\n// ****\r\nfunction Program(gl, vertexSource, fragmentSource) {\r\n  this.initialize = function () {\r\n    this.program = this.compileProgram(vertexSource, fragmentSource);\r\n    this.attribs = this.gatherAttribs();\r\n    this.uniforms = this.gatherUniforms();\r\n  }\r\n\r\n  this.use = function () {\r\n    gl.useProgram(this.program);\r\n  }\r\n\r\n  this.compileProgram = function (vertexSource, fragmentSource) {\r\n    var vertexShader = this.compileShader(vertexSource, gl.VERTEX_SHADER);\r\n    var fragmentShader = this.compileShader(fragmentSource, gl.FRAGMENT_SHADER);\r\n    var program = gl.createProgram();\r\n    gl.attachShader(program, vertexShader);\r\n    gl.attachShader(program, fragmentShader);\r\n    gl.linkProgram(program);\r\n    if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\r\n      console.log(gl.getProgramInfoLog(program));\r\n      throw new Error('Failed to compile program.');\r\n    }\r\n    return program;\r\n  }\r\n\r\n  this.compileShader = function (source, type) {\r\n    var shader = gl.createShader(type);\r\n    gl.shaderSource(shader, source);\r\n    gl.compileShader(shader);\r\n    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\r\n      var err = gl.getShaderInfoLog(shader);\r\n      var lineno = parseInt(err.split(':')[2]);\r\n      var split = source.split('\\n');\r\n      for (var i in split) {\r\n        var q = parseInt(i);\r\n        console.log(q + '  ' + split[i]);\r\n        if (i === lineno - 1) {\r\n          console.warn(err);\r\n        }\r\n      }\r\n      var typeString = type === gl.VERTEX_SHADER ? 'vertex' : 'fragment';\r\n      throw Error('Failed to compile ' + typeString + ' shader.');\r\n    }\r\n    return shader;\r\n  }\r\n\r\n  this.setUniform = function (name, type, value) {\r\n    var args = Array.prototype.slice.call(arguments, 2);\r\n    this.use(); // Make this idempotent. At the context level, perhaps?\r\n    try {\r\n      var location = this.uniforms[name].location;\r\n    }\r\n    catch (e) {\r\n      console.log(name);\r\n      throw e;\r\n    }\r\n    gl['uniform' + type].apply(gl, [location].concat(args));\r\n  }\r\n\r\n  this.gatherUniforms = function () {\r\n    var uniforms = {};\r\n    var nUniforms = gl.getProgramParameter(this.program, gl.ACTIVE_UNIFORMS);\r\n    for (var i = 0; i < nUniforms; i++) {\r\n      var uniform = gl.getActiveUniform(this.program, i);\r\n      uniforms[uniform.name] = {\r\n        name: uniform.name,\r\n        location: gl.getUniformLocation(this.program, uniform.name),\r\n        type: uniform.type,\r\n        size: uniform.size\r\n      };\r\n    }\r\n    return uniforms;\r\n  }\r\n\r\n  this.gatherAttribs = function () {\r\n    var attribs = {};\r\n    var nAttribs = gl.getProgramParameter(this.program, gl.ACTIVE_ATTRIBUTES);\r\n    for (var i = 0; i < nAttribs; i++) {\r\n      var attrib = gl.getActiveAttrib(this.program, i);\r\n      attribs[attrib.name] = {\r\n        name: attrib.name,\r\n        location: gl.getAttribLocation(this.program, attrib.name),\r\n        type: attrib.type,\r\n        size: attrib.size\r\n      };\r\n    }\r\n    return attribs;\r\n  }\r\n  this.initialize();\r\n};\r\nmodule.exports.Program = Program;\r\n","var webgl = require('./webgl.js');\r\n\r\n\r\nmodule.exports.loadProgram = function (gl, source) {\r\n  var noise4d = `//\r\n  // GLSL textureless classic 4D noise \"cnoise\",\r\n  // with an RSL-style periodic variant \"pnoise\".\r\n  // Author:  Stefan Gustavson (stefan.gustavson@liu.se)\r\n  // Version: 2011-08-22\r\n  //\r\n  // Many thanks to Ian McEwan of Ashima Arts for the\r\n  // ideas for permutation and gradient selection.\r\n  //\r\n  // Copyright (c) 2011 Stefan Gustavson. All rights reserved.\r\n  // Distributed under the MIT license. See LICENSE file.\r\n  // https://github.com/ashima/webgl-noise\r\n  //\r\n  \r\n  vec4 mod289 (vec4 x)\r\n  {\r\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\r\n  }\r\n  \r\n  vec4 permute (vec4 x)\r\n  {\r\n    return mod289(((x*34.0)+1.0)*x);\r\n  }\r\n  \r\n  vec4 taylorInvSqrt (vec4 r)\r\n  {\r\n    return 1.79284291400159 - 0.85373472095314 * r;\r\n  }\r\n  \r\n  vec4 fade (vec4 t) {\r\n    return t*t*t*(t*(t*6.0-15.0)+10.0);\r\n  }\r\n  \r\n  // Classic Perlin noise\r\n  float cnoise (vec4 P)\r\n  {\r\n    vec4 Pi0 = floor(P); // Integer part for indexing\r\n    vec4 Pi1 = Pi0 + 1.0; // Integer part + 1\r\n    Pi0 = mod289(Pi0);\r\n    Pi1 = mod289(Pi1);\r\n    vec4 Pf0 = fract(P); // Fractional part for interpolation\r\n    vec4 Pf1 = Pf0 - 1.0; // Fractional part - 1.0\r\n    vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\r\n    vec4 iy = vec4(Pi0.yy, Pi1.yy);\r\n    vec4 iz0 = vec4(Pi0.zzzz);\r\n    vec4 iz1 = vec4(Pi1.zzzz);\r\n    vec4 iw0 = vec4(Pi0.wwww);\r\n    vec4 iw1 = vec4(Pi1.wwww);\r\n  \r\n    vec4 ixy = permute(permute(ix) + iy);\r\n    vec4 ixy0 = permute(ixy + iz0);\r\n    vec4 ixy1 = permute(ixy + iz1);\r\n    vec4 ixy00 = permute(ixy0 + iw0);\r\n    vec4 ixy01 = permute(ixy0 + iw1);\r\n    vec4 ixy10 = permute(ixy1 + iw0);\r\n    vec4 ixy11 = permute(ixy1 + iw1);\r\n  \r\n    vec4 gx00 = ixy00 * (1.0 / 7.0);\r\n    vec4 gy00 = floor(gx00) * (1.0 / 7.0);\r\n    vec4 gz00 = floor(gy00) * (1.0 / 6.0);\r\n    gx00 = fract(gx00) - 0.5;\r\n    gy00 = fract(gy00) - 0.5;\r\n    gz00 = fract(gz00) - 0.5;\r\n    vec4 gw00 = vec4(0.75) - abs(gx00) - abs(gy00) - abs(gz00);\r\n    vec4 sw00 = step(gw00, vec4(0.0));\r\n    gx00 -= sw00 * (step(0.0, gx00) - 0.5);\r\n    gy00 -= sw00 * (step(0.0, gy00) - 0.5);\r\n  \r\n    vec4 gx01 = ixy01 * (1.0 / 7.0);\r\n    vec4 gy01 = floor(gx01) * (1.0 / 7.0);\r\n    vec4 gz01 = floor(gy01) * (1.0 / 6.0);\r\n    gx01 = fract(gx01) - 0.5;\r\n    gy01 = fract(gy01) - 0.5;\r\n    gz01 = fract(gz01) - 0.5;\r\n    vec4 gw01 = vec4(0.75) - abs(gx01) - abs(gy01) - abs(gz01);\r\n    vec4 sw01 = step(gw01, vec4(0.0));\r\n    gx01 -= sw01 * (step(0.0, gx01) - 0.5);\r\n    gy01 -= sw01 * (step(0.0, gy01) - 0.5);\r\n  \r\n    vec4 gx10 = ixy10 * (1.0 / 7.0);\r\n    vec4 gy10 = floor(gx10) * (1.0 / 7.0);\r\n    vec4 gz10 = floor(gy10) * (1.0 / 6.0);\r\n    gx10 = fract(gx10) - 0.5;\r\n    gy10 = fract(gy10) - 0.5;\r\n    gz10 = fract(gz10) - 0.5;\r\n    vec4 gw10 = vec4(0.75) - abs(gx10) - abs(gy10) - abs(gz10);\r\n    vec4 sw10 = step(gw10, vec4(0.0));\r\n    gx10 -= sw10 * (step(0.0, gx10) - 0.5);\r\n    gy10 -= sw10 * (step(0.0, gy10) - 0.5);\r\n  \r\n    vec4 gx11 = ixy11 * (1.0 / 7.0);\r\n    vec4 gy11 = floor(gx11) * (1.0 / 7.0);\r\n    vec4 gz11 = floor(gy11) * (1.0 / 6.0);\r\n    gx11 = fract(gx11) - 0.5;\r\n    gy11 = fract(gy11) - 0.5;\r\n    gz11 = fract(gz11) - 0.5;\r\n    vec4 gw11 = vec4(0.75) - abs(gx11) - abs(gy11) - abs(gz11);\r\n    vec4 sw11 = step(gw11, vec4(0.0));\r\n    gx11 -= sw11 * (step(0.0, gx11) - 0.5);\r\n    gy11 -= sw11 * (step(0.0, gy11) - 0.5);\r\n  \r\n    vec4 g0000 = vec4(gx00.x,gy00.x,gz00.x,gw00.x);\r\n    vec4 g1000 = vec4(gx00.y,gy00.y,gz00.y,gw00.y);\r\n    vec4 g0100 = vec4(gx00.z,gy00.z,gz00.z,gw00.z);\r\n    vec4 g1100 = vec4(gx00.w,gy00.w,gz00.w,gw00.w);\r\n    vec4 g0010 = vec4(gx10.x,gy10.x,gz10.x,gw10.x);\r\n    vec4 g1010 = vec4(gx10.y,gy10.y,gz10.y,gw10.y);\r\n    vec4 g0110 = vec4(gx10.z,gy10.z,gz10.z,gw10.z);\r\n    vec4 g1110 = vec4(gx10.w,gy10.w,gz10.w,gw10.w);\r\n    vec4 g0001 = vec4(gx01.x,gy01.x,gz01.x,gw01.x);\r\n    vec4 g1001 = vec4(gx01.y,gy01.y,gz01.y,gw01.y);\r\n    vec4 g0101 = vec4(gx01.z,gy01.z,gz01.z,gw01.z);\r\n    vec4 g1101 = vec4(gx01.w,gy01.w,gz01.w,gw01.w);\r\n    vec4 g0011 = vec4(gx11.x,gy11.x,gz11.x,gw11.x);\r\n    vec4 g1011 = vec4(gx11.y,gy11.y,gz11.y,gw11.y);\r\n    vec4 g0111 = vec4(gx11.z,gy11.z,gz11.z,gw11.z);\r\n    vec4 g1111 = vec4(gx11.w,gy11.w,gz11.w,gw11.w);\r\n  \r\n    vec4 norm00 = taylorInvSqrt(vec4(dot(g0000, g0000), dot(g0100, g0100), dot(g1000, g1000), dot(g1100, g1100)));\r\n    g0000 *= norm00.x;\r\n    g0100 *= norm00.y;\r\n    g1000 *= norm00.z;\r\n    g1100 *= norm00.w;\r\n  \r\n    vec4 norm01 = taylorInvSqrt(vec4(dot(g0001, g0001), dot(g0101, g0101), dot(g1001, g1001), dot(g1101, g1101)));\r\n    g0001 *= norm01.x;\r\n    g0101 *= norm01.y;\r\n    g1001 *= norm01.z;\r\n    g1101 *= norm01.w;\r\n  \r\n    vec4 norm10 = taylorInvSqrt(vec4(dot(g0010, g0010), dot(g0110, g0110), dot(g1010, g1010), dot(g1110, g1110)));\r\n    g0010 *= norm10.x;\r\n    g0110 *= norm10.y;\r\n    g1010 *= norm10.z;\r\n    g1110 *= norm10.w;\r\n  \r\n    vec4 norm11 = taylorInvSqrt(vec4(dot(g0011, g0011), dot(g0111, g0111), dot(g1011, g1011), dot(g1111, g1111)));\r\n    g0011 *= norm11.x;\r\n    g0111 *= norm11.y;\r\n    g1011 *= norm11.z;\r\n    g1111 *= norm11.w;\r\n  \r\n    float n0000 = dot(g0000, Pf0);\r\n    float n1000 = dot(g1000, vec4(Pf1.x, Pf0.yzw));\r\n    float n0100 = dot(g0100, vec4(Pf0.x, Pf1.y, Pf0.zw));\r\n    float n1100 = dot(g1100, vec4(Pf1.xy, Pf0.zw));\r\n    float n0010 = dot(g0010, vec4(Pf0.xy, Pf1.z, Pf0.w));\r\n    float n1010 = dot(g1010, vec4(Pf1.x, Pf0.y, Pf1.z, Pf0.w));\r\n    float n0110 = dot(g0110, vec4(Pf0.x, Pf1.yz, Pf0.w));\r\n    float n1110 = dot(g1110, vec4(Pf1.xyz, Pf0.w));\r\n    float n0001 = dot(g0001, vec4(Pf0.xyz, Pf1.w));\r\n    float n1001 = dot(g1001, vec4(Pf1.x, Pf0.yz, Pf1.w));\r\n    float n0101 = dot(g0101, vec4(Pf0.x, Pf1.y, Pf0.z, Pf1.w));\r\n    float n1101 = dot(g1101, vec4(Pf1.xy, Pf0.z, Pf1.w));\r\n    float n0011 = dot(g0011, vec4(Pf0.xy, Pf1.zw));\r\n    float n1011 = dot(g1011, vec4(Pf1.x, Pf0.y, Pf1.zw));\r\n    float n0111 = dot(g0111, vec4(Pf0.x, Pf1.yzw));\r\n    float n1111 = dot(g1111, Pf1);\r\n  \r\n    vec4 fade_xyzw = fade(Pf0);\r\n    vec4 n_0w = mix(vec4(n0000, n1000, n0100, n1100), vec4(n0001, n1001, n0101, n1101), fade_xyzw.w);\r\n    vec4 n_1w = mix(vec4(n0010, n1010, n0110, n1110), vec4(n0011, n1011, n0111, n1111), fade_xyzw.w);\r\n    vec4 n_zw = mix(n_0w, n_1w, fade_xyzw.z);\r\n    vec2 n_yzw = mix(n_zw.xy, n_zw.zw, fade_xyzw.y);\r\n    float n_xyzw = mix(n_yzw.x, n_yzw.y, fade_xyzw.x);\r\n    return 2.2 * n_xyzw;\r\n  }\r\n  \r\n  // Classic Perlin noise, periodic version\r\n  float pnoise (vec4 P, vec4 rep)\r\n  {\r\n    vec4 Pi0 = mod(floor(P), rep); // Integer part modulo rep\r\n    vec4 Pi1 = mod(Pi0 + 1.0, rep); // Integer part + 1 mod rep\r\n    Pi0 = mod289(Pi0);\r\n    Pi1 = mod289(Pi1);\r\n    vec4 Pf0 = fract(P); // Fractional part for interpolation\r\n    vec4 Pf1 = Pf0 - 1.0; // Fractional part - 1.0\r\n    vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\r\n    vec4 iy = vec4(Pi0.yy, Pi1.yy);\r\n    vec4 iz0 = vec4(Pi0.zzzz);\r\n    vec4 iz1 = vec4(Pi1.zzzz);\r\n    vec4 iw0 = vec4(Pi0.wwww);\r\n    vec4 iw1 = vec4(Pi1.wwww);\r\n  \r\n    vec4 ixy = permute(permute(ix) + iy);\r\n    vec4 ixy0 = permute(ixy + iz0);\r\n    vec4 ixy1 = permute(ixy + iz1);\r\n    vec4 ixy00 = permute(ixy0 + iw0);\r\n    vec4 ixy01 = permute(ixy0 + iw1);\r\n    vec4 ixy10 = permute(ixy1 + iw0);\r\n    vec4 ixy11 = permute(ixy1 + iw1);\r\n  \r\n    vec4 gx00 = ixy00 * (1.0 / 7.0);\r\n    vec4 gy00 = floor(gx00) * (1.0 / 7.0);\r\n    vec4 gz00 = floor(gy00) * (1.0 / 6.0);\r\n    gx00 = fract(gx00) - 0.5;\r\n    gy00 = fract(gy00) - 0.5;\r\n    gz00 = fract(gz00) - 0.5;\r\n    vec4 gw00 = vec4(0.75) - abs(gx00) - abs(gy00) - abs(gz00);\r\n    vec4 sw00 = step(gw00, vec4(0.0));\r\n    gx00 -= sw00 * (step(0.0, gx00) - 0.5);\r\n    gy00 -= sw00 * (step(0.0, gy00) - 0.5);\r\n  \r\n    vec4 gx01 = ixy01 * (1.0 / 7.0);\r\n    vec4 gy01 = floor(gx01) * (1.0 / 7.0);\r\n    vec4 gz01 = floor(gy01) * (1.0 / 6.0);\r\n    gx01 = fract(gx01) - 0.5;\r\n    gy01 = fract(gy01) - 0.5;\r\n    gz01 = fract(gz01) - 0.5;\r\n    vec4 gw01 = vec4(0.75) - abs(gx01) - abs(gy01) - abs(gz01);\r\n    vec4 sw01 = step(gw01, vec4(0.0));\r\n    gx01 -= sw01 * (step(0.0, gx01) - 0.5);\r\n    gy01 -= sw01 * (step(0.0, gy01) - 0.5);\r\n  \r\n    vec4 gx10 = ixy10 * (1.0 / 7.0);\r\n    vec4 gy10 = floor(gx10) * (1.0 / 7.0);\r\n    vec4 gz10 = floor(gy10) * (1.0 / 6.0);\r\n    gx10 = fract(gx10) - 0.5;\r\n    gy10 = fract(gy10) - 0.5;\r\n    gz10 = fract(gz10) - 0.5;\r\n    vec4 gw10 = vec4(0.75) - abs(gx10) - abs(gy10) - abs(gz10);\r\n    vec4 sw10 = step(gw10, vec4(0.0));\r\n    gx10 -= sw10 * (step(0.0, gx10) - 0.5);\r\n    gy10 -= sw10 * (step(0.0, gy10) - 0.5);\r\n  \r\n    vec4 gx11 = ixy11 * (1.0 / 7.0);\r\n    vec4 gy11 = floor(gx11) * (1.0 / 7.0);\r\n    vec4 gz11 = floor(gy11) * (1.0 / 6.0);\r\n    gx11 = fract(gx11) - 0.5;\r\n    gy11 = fract(gy11) - 0.5;\r\n    gz11 = fract(gz11) - 0.5;\r\n    vec4 gw11 = vec4(0.75) - abs(gx11) - abs(gy11) - abs(gz11);\r\n    vec4 sw11 = step(gw11, vec4(0.0));\r\n    gx11 -= sw11 * (step(0.0, gx11) - 0.5);\r\n    gy11 -= sw11 * (step(0.0, gy11) - 0.5);\r\n  \r\n    vec4 g0000 = vec4(gx00.x,gy00.x,gz00.x,gw00.x);\r\n    vec4 g1000 = vec4(gx00.y,gy00.y,gz00.y,gw00.y);\r\n    vec4 g0100 = vec4(gx00.z,gy00.z,gz00.z,gw00.z);\r\n    vec4 g1100 = vec4(gx00.w,gy00.w,gz00.w,gw00.w);\r\n    vec4 g0010 = vec4(gx10.x,gy10.x,gz10.x,gw10.x);\r\n    vec4 g1010 = vec4(gx10.y,gy10.y,gz10.y,gw10.y);\r\n    vec4 g0110 = vec4(gx10.z,gy10.z,gz10.z,gw10.z);\r\n    vec4 g1110 = vec4(gx10.w,gy10.w,gz10.w,gw10.w);\r\n    vec4 g0001 = vec4(gx01.x,gy01.x,gz01.x,gw01.x);\r\n    vec4 g1001 = vec4(gx01.y,gy01.y,gz01.y,gw01.y);\r\n    vec4 g0101 = vec4(gx01.z,gy01.z,gz01.z,gw01.z);\r\n    vec4 g1101 = vec4(gx01.w,gy01.w,gz01.w,gw01.w);\r\n    vec4 g0011 = vec4(gx11.x,gy11.x,gz11.x,gw11.x);\r\n    vec4 g1011 = vec4(gx11.y,gy11.y,gz11.y,gw11.y);\r\n    vec4 g0111 = vec4(gx11.z,gy11.z,gz11.z,gw11.z);\r\n    vec4 g1111 = vec4(gx11.w,gy11.w,gz11.w,gw11.w);\r\n  \r\n    vec4 norm00 = taylorInvSqrt(vec4(dot(g0000, g0000), dot(g0100, g0100), dot(g1000, g1000), dot(g1100, g1100)));\r\n    g0000 *= norm00.x;\r\n    g0100 *= norm00.y;\r\n    g1000 *= norm00.z;\r\n    g1100 *= norm00.w;\r\n  \r\n    vec4 norm01 = taylorInvSqrt(vec4(dot(g0001, g0001), dot(g0101, g0101), dot(g1001, g1001), dot(g1101, g1101)));\r\n    g0001 *= norm01.x;\r\n    g0101 *= norm01.y;\r\n    g1001 *= norm01.z;\r\n    g1101 *= norm01.w;\r\n  \r\n    vec4 norm10 = taylorInvSqrt(vec4(dot(g0010, g0010), dot(g0110, g0110), dot(g1010, g1010), dot(g1110, g1110)));\r\n    g0010 *= norm10.x;\r\n    g0110 *= norm10.y;\r\n    g1010 *= norm10.z;\r\n    g1110 *= norm10.w;\r\n  \r\n    vec4 norm11 = taylorInvSqrt(vec4(dot(g0011, g0011), dot(g0111, g0111), dot(g1011, g1011), dot(g1111, g1111)));\r\n    g0011 *= norm11.x;\r\n    g0111 *= norm11.y;\r\n    g1011 *= norm11.z;\r\n    g1111 *= norm11.w;\r\n  \r\n    float n0000 = dot(g0000, Pf0);\r\n    float n1000 = dot(g1000, vec4(Pf1.x, Pf0.yzw));\r\n    float n0100 = dot(g0100, vec4(Pf0.x, Pf1.y, Pf0.zw));\r\n    float n1100 = dot(g1100, vec4(Pf1.xy, Pf0.zw));\r\n    float n0010 = dot(g0010, vec4(Pf0.xy, Pf1.z, Pf0.w));\r\n    float n1010 = dot(g1010, vec4(Pf1.x, Pf0.y, Pf1.z, Pf0.w));\r\n    float n0110 = dot(g0110, vec4(Pf0.x, Pf1.yz, Pf0.w));\r\n    float n1110 = dot(g1110, vec4(Pf1.xyz, Pf0.w));\r\n    float n0001 = dot(g0001, vec4(Pf0.xyz, Pf1.w));\r\n    float n1001 = dot(g1001, vec4(Pf1.x, Pf0.yz, Pf1.w));\r\n    float n0101 = dot(g0101, vec4(Pf0.x, Pf1.y, Pf0.z, Pf1.w));\r\n    float n1101 = dot(g1101, vec4(Pf1.xy, Pf0.z, Pf1.w));\r\n    float n0011 = dot(g0011, vec4(Pf0.xy, Pf1.zw));\r\n    float n1011 = dot(g1011, vec4(Pf1.x, Pf0.y, Pf1.zw));\r\n    float n0111 = dot(g0111, vec4(Pf0.x, Pf1.yzw));\r\n    float n1111 = dot(g1111, Pf1);\r\n  \r\n    vec4 fade_xyzw = fade(Pf0);\r\n    vec4 n_0w = mix(vec4(n0000, n1000, n0100, n1100), vec4(n0001, n1001, n0101, n1101), fade_xyzw.w);\r\n    vec4 n_1w = mix(vec4(n0010, n1010, n0110, n1110), vec4(n0011, n1011, n0111, n1111), fade_xyzw.w);\r\n    vec4 n_zw = mix(n_0w, n_1w, fade_xyzw.z);\r\n    vec2 n_yzw = mix(n_zw.xy, n_zw.zw, fade_xyzw.y);\r\n    float n_xyzw = mix(n_yzw.x, n_yzw.y, fade_xyzw.x);\r\n    return 2.2 * n_xyzw;\r\n  }`;\r\n  source = source.replace('__noise4d__', noise4d);\r\n  source = source.split('__split__');\r\n  var program = new webgl.Program(gl, source[0], source[1]);\r\n  return program;\r\n};\r\n","var glm = require('gl-matrix');\r\nvar webgl = require('./webgl.js');\r\nvar util = require('./util.js');\r\nvar rng = require('rng');\r\n\r\nvar NSTARS = 100000;\r\n\r\n\r\nmodule.exports = function () {\r\n  this.init = function () {\r\n    // Initialize the offscreen rendering canvas.\r\n    this.canvas = document.createElement('canvas');\r\n\r\n    // Initialize the gl context.\r\n    this.gl = this.canvas.getContext('webgl');\r\n    this.gl.enable(this.gl.BLEND);\r\n    this.gl.blendFuncSeparate(this.gl.SRC_ALPHA, this.gl.ONE_MINUS_SRC_ALPHA, this.gl.ZERO, this.gl.ONE);\r\n\r\n    // Load the programs.\r\n    var nebula = `#version 100\r\n    precision highp float;\r\n    \r\n    uniform mat4 uModel;\r\n    uniform mat4 uView;\r\n    uniform mat4 uProjection;\r\n    \r\n    attribute vec3 aPosition;\r\n    varying vec3 pos;\r\n    \r\n    void main () {\r\n      gl_Position = uProjection * uView * uModel * vec4(aPosition, 1);\r\n      pos = (uModel * vec4(aPosition, 1)).xyz;\r\n    }\r\n    \r\n    \r\n    __split__\r\n    \r\n    \r\n    #version 100\r\n    precision highp float;\r\n    \r\n    uniform vec3 uColor;\r\n    uniform vec3 uOffset;\r\n    uniform float uScale;\r\n    uniform float uIntensity;\r\n    uniform float uFalloff;\r\n    \r\n    varying vec3 pos;\r\n    \r\n    __noise4d__\r\n    \r\n    float noise (vec3 p) {\r\n        return 0.5 * cnoise(vec4(p, 0)) + 0.5;\r\n    }\r\n    \r\n    float nebula (vec3 p) {\r\n      const int steps = 6;\r\n      float scale = pow(2.0, float(steps));\r\n      vec3 displace;\r\n      for (int i = 0; i < steps; i++) {\r\n        displace = vec3(\r\n          noise(p.xyz * scale + displace),\r\n          noise(p.yzx * scale + displace),\r\n          noise(p.zxy * scale + displace)\r\n        );\r\n        scale *= 0.5;\r\n      }\r\n      return noise(p * scale + displace);\r\n    }\r\n    \r\n    void main () {\r\n      vec3 posn = normalize(pos) * uScale;\r\n      float c = min(1.0, nebula(posn + uOffset) * uIntensity);\r\n      c = pow(c, uFalloff);\r\n      gl_FragColor = vec4(uColor, c);\r\n    }`;\r\n    var pointStars = `#version 100\r\n    precision highp float;\r\n    \r\n    uniform mat4 uModel;\r\n    uniform mat4 uView;\r\n    uniform mat4 uProjection;\r\n    \r\n    attribute vec3 aPosition;\r\n    attribute vec3 aColor;\r\n    \r\n    varying vec3 color;\r\n    \r\n    void main () {\r\n      gl_Position = uProjection * uView * uModel * vec4(aPosition, 1);\r\n      color = aColor;\r\n    }\r\n    \r\n    \r\n    __split__\r\n    \r\n    \r\n    #version 100\r\n    precision highp float;\r\n    \r\n    \r\n    varying vec3 color;\r\n    \r\n    void main () {\r\n      gl_FragColor = vec4(color, 1.0);\r\n    }`;\r\n    var star = `#version 100\r\n    precision highp float;\r\n    \r\n    uniform mat4 uModel;\r\n    uniform mat4 uView;\r\n    uniform mat4 uProjection;\r\n    \r\n    attribute vec3 aPosition;\r\n    varying vec3 pos;\r\n    \r\n    void main () {\r\n      gl_Position = uProjection * uView * uModel * vec4(aPosition, 1);\r\n      pos = (uModel * vec4(aPosition, 1)).xyz;\r\n    }\r\n    \r\n    \r\n    __split__\r\n    \r\n    \r\n    #version 100\r\n    precision highp float;\r\n    \r\n    uniform vec3 uPosition;\r\n    uniform vec3 uColor;\r\n    uniform float uSize;\r\n    uniform float uFalloff;\r\n    \r\n    varying vec3 pos;\r\n    \r\n    void main () {\r\n      vec3 posn = normalize(pos);\r\n      float d = 1.0 - clamp(dot(posn, normalize(uPosition)), 0.0, 1.0);\r\n      float i = exp(-(d - uSize) * uFalloff);\r\n      float o = clamp(i, 0.0, 1.0);\r\n      gl_FragColor = vec4(uColor + i, o);\r\n    }`;\r\n    var sun = `#version 100\r\n    precision highp float;\r\n    \r\n    uniform mat4 uModel;\r\n    uniform mat4 uView;\r\n    uniform mat4 uProjection;\r\n    \r\n    attribute vec3 aPosition;\r\n    varying vec3 pos;\r\n    \r\n    void main () {\r\n      gl_Position = uProjection * uView * uModel * vec4(aPosition, 1);\r\n      pos = (uModel * vec4(aPosition, 1)).xyz;\r\n    }\r\n    \r\n    \r\n    __split__\r\n    \r\n    \r\n    #version 100\r\n    precision highp float;\r\n    \r\n    uniform vec3 uPosition;\r\n    uniform vec3 uColor;\r\n    uniform float uSize;\r\n    uniform float uFalloff;\r\n    \r\n    varying vec3 pos;\r\n    \r\n    void main () {\r\n      vec3 posn = normalize(pos);\r\n      float d = clamp(dot(posn, normalize(uPosition)), 0.0, 1.0);\r\n      float c = smoothstep(1.0 - uSize * 32.0, 1.0 - uSize, d);\r\n      c += pow(d, uFalloff) * 0.5;\r\n      vec3 color = mix(uColor, vec3(1,1,1), c);\r\n      gl_FragColor = vec4(color, c);\r\n    }`;\r\n    nebula = nebula.toString('utf-8');\r\n    pointStars = pointStars.toString('utf-8');\r\n    star = star.toString('utf-8');\r\n    sun = sun.toString('utf-8');\r\n    this.pNebula = util.loadProgram(this.gl, nebula);\r\n    this.pPointStars = util.loadProgram(this.gl, pointStars);\r\n    this.pStar = util.loadProgram(this.gl, star);\r\n    this.pSun = util.loadProgram(this.gl, sun);\r\n\r\n    // Create the point stars renderable.\r\n    var rand = new rng.MT(hashcode('best seed ever') + 5000);\r\n    var position = new Float32Array(18 * NSTARS);\r\n    var color = new Float32Array(18 * NSTARS);\r\n    for (var i = 0; i < NSTARS; i++) {\r\n      var size = 0.05;\r\n      var pos = glm.vec3.random(glm.vec3.create(), 1.0);\r\n      star = buildStar(size, pos, 128.0, rand);\r\n      position.set(star.position, i * 18);\r\n      color.set(star.color, i * 18);\r\n    }\r\n    var attribs = webgl.buildAttribs(this.gl, { aPosition: 3, aColor: 3 });\r\n    attribs.aPosition.buffer.set(position);\r\n    attribs.aColor.buffer.set(color);\r\n    var count = position.length / 9;\r\n    this.rPointStars = new webgl.Renderable(this.gl, this.pPointStars, attribs, count);\r\n\r\n    // Create the nebula, sun, and star renderables.\r\n    this.rNebula = buildBox(this.gl, this.pNebula);\r\n    this.rSun = buildBox(this.gl, this.pSun);\r\n    this.rStar = buildBox(this.gl, this.pStar);\r\n  };\r\n\r\n  this.render = function (params) {\r\n    // We'll be returning a map of direction to texture.\r\n    var textures = {};\r\n\r\n    // Handle changes to resolution.\r\n    this.canvas.width = this.canvas.height = params.resolution;\r\n    this.gl.viewport(0, 0, params.resolution, params.resolution);\r\n\r\n    // Initialize the point star parameters.\r\n    var rand = new rng.MT(hashcode(params.seed) + 1000);\r\n    var pStarParams = [];\r\n    while (params.pointStars) {\r\n      pStarParams.push({\r\n        rotation: randomRotation(rand),\r\n      });\r\n      if (rand.random() < 0.2) {\r\n        break;\r\n      }\r\n    }\r\n    // Initialize the star parameters.\r\n    rand = new rng.MT(hashcode(params.seed) + 3000);\r\n    var starParams = [];\r\n    while (params.stars) {\r\n      starParams.push({\r\n        pos: randomVec3(rand),\r\n        color: [1, 1, 1],\r\n        size: 0.0,\r\n        falloff: rand.random() * Math.pow(2, 20) + Math.pow(2, 20),\r\n      });\r\n      if (rand.random() < 0.01) {\r\n        break;\r\n      }\r\n    }\r\n    // Initialize the nebula parameters.\r\n    rand = new rng.MT(hashcode(params.seed) + 2000);\r\n    var nebulaParams = [];\r\n    while (params.nebulae) {\r\n      nebulaParams.push({\r\n        scale: rand.random() * 0.5 + 0.25,\r\n        color: [rand.random(), rand.random(), rand.random()],\r\n        intensity: rand.random() * 0.2 + 0.9,\r\n        falloff: rand.random() * 3.0 + 3.0,\r\n        offset: [rand.random() * 2000 - 1000, rand.random() * 2000 - 1000, rand.random() * 2000 - 1000],\r\n      });\r\n      if (rand.random() < 0.5) {\r\n        break;\r\n      }\r\n    }\r\n    // Initialize the sun parameters.\r\n    rand = new rng.MT(hashcode(params.seed) + 4000);\r\n    var sunParams = [];\r\n    if (params.sun) {\r\n      sunParams.push({\r\n        pos: randomVec3(rand),\r\n        color: [rand.random(), rand.random(), rand.random()],\r\n        size: rand.random() * 0.0001 + 0.0001,\r\n        falloff: rand.random() * 16.0 + 8.0,\r\n      });\r\n    }\r\n    // Create a list of directions we'll be iterating over.\r\n    var dirs = {\r\n      front: {\r\n        target: [0, 0, -1],\r\n        up: [0, 1, 0]\r\n      },\r\n      back: {\r\n        target: [0, 0, 1],\r\n        up: [0, 1, 0]\r\n      },\r\n      left: {\r\n        target: [-1, 0, 0],\r\n        up: [0, 1, 0]\r\n      },\r\n      right: {\r\n        target: [1, 0, 0],\r\n        up: [0, 1, 0]\r\n      },\r\n      top: {\r\n        target: [0, 1, 0],\r\n        up: [0, 0, 1]\r\n      },\r\n      bottom: {\r\n        target: [0, -1, 0],\r\n        up: [0, 0, -1]\r\n      }\r\n    };\r\n\r\n    // Define and initialize the model, view, and projection matrices.\r\n    var model = glm.mat4.create();\r\n    var view = glm.mat4.create();\r\n    var projection = glm.mat4.create();\r\n    glm.mat4.perspective(projection, Math.PI / 2, 1.0, 0.1, 256);\r\n    // Iterate over the directions to render and create the textures.\r\n    var keys = Object.keys(dirs);\r\n    for (var i = 0; i < keys.length; i++) {\r\n      // Clear the context.\r\n      this.gl.clearColor(0, 0, 0, 1);\r\n      this.gl.clear(this.gl.COLOR_BUFFER_BIT);\r\n      // Look in the direection for this texture.\r\n      var dir = dirs[keys[i]];\r\n      glm.mat4.lookAt(view, [0, 0, 0], dir.target, dir.up);\r\n      // Render the point stars.\r\n      this.pPointStars.use();\r\n      model = glm.mat4.create();\r\n      this.pPointStars.setUniform('uView', 'Matrix4fv', false, view);\r\n      this.pPointStars.setUniform('uProjection', 'Matrix4fv', false, projection);\r\n      for (var j = 0; j < pStarParams.length; j++) {\r\n        var ps = pStarParams[j];\r\n        glm.mat4.mul(model, ps.rotation, model);\r\n        this.pPointStars.setUniform('uModel', 'Matrix4fv', false, model);\r\n        this.rPointStars.render();\r\n      }\r\n      // Render the stars.\r\n      this.pStar.use();\r\n      this.pStar.setUniform('uView', 'Matrix4fv', false, view);\r\n      this.pStar.setUniform('uProjection', 'Matrix4fv', false, projection);\r\n      this.pStar.setUniform('uModel', 'Matrix4fv', false, model);\r\n      for (j = 0; j < starParams.length; j++) {\r\n        var s = starParams[j];\r\n        this.pStar.setUniform('uPosition', '3fv', s.pos);\r\n        this.pStar.setUniform('uColor', '3fv', s.color);\r\n        this.pStar.setUniform('uSize', '1f', s.size);\r\n        this.pStar.setUniform('uFalloff', '1f', s.falloff);\r\n        this.rStar.render();\r\n      }\r\n      // Render the nebulae.\r\n      this.pNebula.use();\r\n      model = glm.mat4.create();\r\n      for (j = 0; j < nebulaParams.length; j++) {\r\n        var p = nebulaParams[j];\r\n        this.pNebula.setUniform('uModel', 'Matrix4fv', false, model);\r\n        this.pNebula.setUniform('uView', 'Matrix4fv', false, view);\r\n        this.pNebula.setUniform('uProjection', 'Matrix4fv', false, projection);\r\n        this.pNebula.setUniform('uScale', '1f', p.scale);\r\n        this.pNebula.setUniform('uColor', '3fv', p.color);\r\n        this.pNebula.setUniform('uIntensity', '1f', p.intensity);\r\n        this.pNebula.setUniform('uFalloff', '1f', p.falloff);\r\n        this.pNebula.setUniform('uOffset', '3fv', p.offset);\r\n        this.rNebula.render();\r\n      }\r\n      // Render the suns.\r\n      this.pSun.use();\r\n      this.pSun.setUniform('uView', 'Matrix4fv', false, view);\r\n      this.pSun.setUniform('uProjection', 'Matrix4fv', false, projection);\r\n      this.pSun.setUniform('uModel', 'Matrix4fv', false, model);\r\n      for (j = 0; j < sunParams.length; j++) {\r\n        var sun = sunParams[j];\r\n        this.pSun.setUniform('uPosition', '3fv', sun.pos);\r\n        this.pSun.setUniform('uColor', '3fv', sun.color);\r\n        this.pSun.setUniform('uSize', '1f', sun.size);\r\n        this.pSun.setUniform('uFalloff', '1f', sun.falloff);\r\n        this.rSun.render();\r\n      }\r\n      // Create the texture.\r\n      var c = document.createElement('canvas');\r\n      c.width = c.height = params.resolution;\r\n      var ctx = c.getContext('2d');\r\n      ctx.drawImage(this.canvas, 0, 0);\r\n      textures[keys[i]] = c;\r\n    }\r\n    return textures;\r\n  };\r\n  this.init();\r\n};\r\n\r\n\r\nfunction buildStar(size, pos, dist, rand) {\r\n  var c = Math.pow(rand.random(), 4.0);\r\n  var color = [\r\n    c, c, c,\r\n    c, c, c,\r\n    c, c, c,\r\n    c, c, c,\r\n    c, c, c,\r\n    c, c, c\r\n  ];\r\n\r\n  var vertices = [\r\n    [-size, -size, 0],\r\n    [size, -size, 0],\r\n    [size, size, 0],\r\n    [-size, -size, 0],\r\n    [size, size, 0],\r\n    [-size, size, 0]\r\n  ];\r\n\r\n  var position = [];\r\n\r\n  for (var ii = 0; ii < 6; ii++) {\r\n    var rot = quatRotFromForward(pos);\r\n    glm.vec3.transformQuat(vertices[ii], vertices[ii], rot);\r\n    vertices[ii][0] += pos[0] * dist;\r\n    vertices[ii][1] += pos[1] * dist;\r\n    vertices[ii][2] += pos[2] * dist;\r\n    position.push.apply(position, vertices[ii]);\r\n  }\r\n\r\n  return {\r\n    position: position,\r\n    color: color\r\n  };\r\n}\r\n\r\n\r\nfunction buildBox(gl, program) {\r\n  var position = [\r\n    -1, -1, -1,\r\n    1, -1, -1,\r\n    1, 1, -1,\r\n    -1, -1, -1,\r\n    1, 1, -1,\r\n    -1, 1, -1,\r\n\r\n    1, -1, 1,\r\n    -1, -1, 1,\r\n    -1, 1, 1,\r\n    1, -1, 1,\r\n    -1, 1, 1,\r\n    1, 1, 1,\r\n\r\n    1, -1, -1,\r\n    1, -1, 1,\r\n    1, 1, 1,\r\n    1, -1, -1,\r\n    1, 1, 1,\r\n    1, 1, -1,\r\n\r\n    -1, -1, 1,\r\n    -1, -1, -1,\r\n    -1, 1, -1,\r\n    -1, -1, 1,\r\n    -1, 1, -1,\r\n    -1, 1, 1,\r\n\r\n    -1, 1, -1,\r\n    1, 1, -1,\r\n    1, 1, 1,\r\n    -1, 1, -1,\r\n    1, 1, 1,\r\n    -1, 1, 1,\r\n\r\n    -1, -1, 1,\r\n    1, -1, 1,\r\n    1, -1, -1,\r\n    -1, -1, 1,\r\n    1, -1, -1,\r\n    -1, -1, -1\r\n  ];\r\n  var attribs = webgl.buildAttribs(gl, { aPosition: 3 });\r\n  attribs.aPosition.buffer.set(new Float32Array(position));\r\n  var count = position.length / 9;\r\n  var renderable = new webgl.Renderable(gl, program, attribs, count);\r\n  return renderable;\r\n}\r\n\r\n\r\nfunction quatRotBetweenVecs(a, b) {\r\n  var theta = Math.acos(glm.vec3.dot(a, b));\r\n  var omega = glm.vec3.create();\r\n  glm.vec3.cross(omega, a, b);\r\n  glm.vec3.normalize(omega, omega);\r\n  var rot = glm.quat.create();\r\n  glm.quat.setAxisAngle(rot, omega, theta);\r\n  return rot;\r\n}\r\n\r\n\r\nfunction quatRotFromForward(b) {\r\n  return quatRotBetweenVecs(glm.vec3.fromValues(0, 0, -1), b);\r\n}\r\n\r\n\r\nfunction randomRotation(rand) {\r\n  var rot = glm.mat4.create();\r\n  glm.mat4.rotateX(rot, rot, rand.random() * Math.PI * 2);\r\n  glm.mat4.rotateY(rot, rot, rand.random() * Math.PI * 2);\r\n  glm.mat4.rotateZ(rot, rot, rand.random() * Math.PI * 2);\r\n  return rot;\r\n}\r\n\r\n\r\nfunction randomVec3(rand) {\r\n  var v = [0, 0, 1];\r\n  var rot = randomRotation(rand);\r\n  glm.vec3.transformMat4(v, v, rot);\r\n  glm.vec3.normalize(v, v);\r\n  return v;\r\n}\r\n\r\n\r\nfunction hashcode(str) {\r\n  var hash = 0;\r\n  for (var i = 0; i < str.length; i++) {\r\n    var char = str.charCodeAt(i);\r\n    hash += (i + 1) * char;\r\n  }\r\n  return hash;\r\n}\r\n","var glm = require('gl-matrix');\r\nvar webgl = require('./webgl.js');\r\nvar util = require('./util.js');\r\n\r\n\r\nmodule.exports = function (renderCanvas) {\r\n  this.init = function () {\r\n    this.gl = renderCanvas.getContext('webgl');\r\n    this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL, true);\r\n    var skybox = `#version 100\r\n    precision highp float;\r\n    \r\n    uniform mat4 uModel;\r\n    uniform mat4 uView;\r\n    uniform mat4 uProjection;\r\n    \r\n    attribute vec3 aPosition;\r\n    attribute vec2 aUV;\r\n    \r\n    varying vec2 uv;\r\n    \r\n    void main () {\r\n      gl_Position = uProjection * uView * uModel * vec4(aPosition, 1);\r\n      uv = aUV;\r\n    }\r\n    \r\n    \r\n    __split__\r\n    \r\n    \r\n    #version 100\r\n    precision highp float;\r\n    \r\n    uniform sampler2D uTexture;\r\n    \r\n    varying vec2 uv;\r\n    \r\n    void main () {\r\n      gl_FragColor = texture2D(uTexture, uv);\r\n    }`;\r\n    skybox = skybox.toString('utf-8');\r\n    this.pSkybox = util.loadProgram(this.gl, skybox);\r\n    this.rSkybox = buildQuad(this.gl, this.pSkybox);\r\n    this.textures = {};\r\n  };\r\n\r\n  this.setTextures = function (canvases) {\r\n    this.textures = {};\r\n    var keys = Object.keys(canvases);\r\n    for (var i = 0; i < keys.length; i++) {\r\n      var c = canvases[keys[i]];\r\n      this.textures[keys[i]] = new webgl.Texture(this.gl, 0, c, c.width, c.height, {\r\n        min: this.gl.LINEAR_MIPMAP_LINEAR,\r\n        mag: this.gl.LINEAR,\r\n      });\r\n    }\r\n  };\r\n\r\n  this.render = function (view, projection) {\r\n    this.gl.viewport(0, 0, renderCanvas.width, renderCanvas.height);\r\n\r\n    var model = glm.mat4.create();\r\n\r\n    this.pSkybox.use();\r\n    this.pSkybox.setUniform('uView', 'Matrix4fv', false, view);\r\n    this.pSkybox.setUniform('uProjection', 'Matrix4fv', false, projection);\r\n\r\n    this.textures.front.bind();\r\n    this.pSkybox.setUniform('uModel', 'Matrix4fv', false, model);\r\n    this.rSkybox.render();\r\n\r\n    this.textures.back.bind();\r\n    glm.mat4.rotateY(model, glm.mat4.create(), Math.PI);\r\n    this.pSkybox.setUniform('uModel', 'Matrix4fv', false, model);\r\n    this.rSkybox.render();\r\n\r\n    this.textures.left.bind();\r\n    glm.mat4.rotateY(model, glm.mat4.create(), Math.PI / 2);\r\n    this.pSkybox.setUniform('uModel', 'Matrix4fv', false, model);\r\n    this.rSkybox.render();\r\n\r\n    this.textures.right.bind();\r\n    glm.mat4.rotateY(model, glm.mat4.create(), -Math.PI / 2);\r\n    this.pSkybox.setUniform('uModel', 'Matrix4fv', false, model);\r\n    this.rSkybox.render();\r\n\r\n    this.textures.top.bind();\r\n    glm.mat4.rotateX(model, glm.mat4.create(), Math.PI / 2);\r\n    this.pSkybox.setUniform('uModel', 'Matrix4fv', false, model);\r\n    this.rSkybox.render();\r\n\r\n    this.textures.bottom.bind();\r\n    glm.mat4.rotateX(model, glm.mat4.create(), -Math.PI / 2);\r\n    this.pSkybox.setUniform('uModel', 'Matrix4fv', false, model);\r\n    this.rSkybox.render();\r\n  };\r\n  this.init();\r\n};\r\n\r\n\r\nfunction buildQuad(gl, program) {\r\n  var position = [\r\n    -1, -1, -1,\r\n    1, -1, -1,\r\n    1, 1, -1,\r\n    -1, -1, -1,\r\n    1, 1, -1,\r\n    -1, 1, -1,\r\n  ];\r\n  var uv = [\r\n    0, 0,\r\n    1, 0,\r\n    1, 1,\r\n    0, 0,\r\n    1, 1,\r\n    0, 1\r\n  ];\r\n  var attribs = webgl.buildAttribs(gl, { aPosition: 3, aUV: 2 });\r\n  attribs.aPosition.buffer.set(new Float32Array(position));\r\n  attribs.aUV.buffer.set(new Float32Array(uv));\r\n  var count = position.length / 9;\r\n  var renderable = new webgl.Renderable(gl, program, attribs, count);\r\n  return renderable;\r\n}\r\n","import React from 'react';\nimport './app.css';\n//import twitter from './twitter.svg';\n//import twitch from './twitch.svg';\n//import soundcloud from './soundcloud.svg';\n//import youtube from './youtube.svg';\n\nvar glm = require('gl-matrix');\nvar Space3D = require('./space-3d.js');\nvar Skybox = require('./skybox.js');\n\n\nvar fov = 60;\nfov = (fov / 360) * Math.PI * 2;\nvar pointStars = true;\nvar seed = (Math.random() * 1000000000000000000).toString(36);\nvar stars = true;\nvar sun = true;\nvar nebulae = true;\nvar resolution = 1024;\nvar animationSpeed = 0.015;\nvar unifiedTexture = true;\nvar renderCanvas = document.getElementById('render-canvas');\nrenderCanvas.width = window.innerWidth;\nrenderCanvas.height = window.innerHeight;\nvar skybox = new Skybox(renderCanvas);\nvar space = new Space3D(resolution);\nvar tick = 0.0;\n\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.renderSpace = this.renderSpace.bind(this);\n\n    this.renderTextures();\n    this.renderSpace();\n  }\n\n  hideUnified() {\n    document.getElementById('texture-canvas').style.display = 'none';\n  }\n\n  hideSplit() {\n    document.getElementById('texture-left').style.display = 'none';\n    document.getElementById('texture-right').style.display = 'none';\n    document.getElementById('texture-top').style.display = 'none';\n    document.getElementById('texture-bottom').style.display = 'none';\n    document.getElementById('texture-front').style.display = 'none';\n    document.getElementById('texture-back').style.display = 'none';\n  }\n\n  renderTextures() {\n    var textures = space.render({\n      seed: seed,\n      pointStars: pointStars,\n      stars: stars,\n      sun: sun,\n      nebulae: nebulae,\n      unifiedTexture: unifiedTexture,\n      resolution: resolution,\n    });\n    skybox.setTextures(textures);\n    var canvas = document.getElementById('texture-canvas');\n    canvas.width = 4 * resolution;\n    canvas.height = 3 * resolution;\n    var ctx = canvas.getContext('2d');\n    ctx.drawImage(textures.left, resolution * 0, resolution * 1);\n    ctx.drawImage(textures.right, resolution * 2, resolution * 1);\n    ctx.drawImage(textures.front, resolution * 1, resolution * 1);\n    ctx.drawImage(textures.back, resolution * 3, resolution * 1);\n    ctx.drawImage(textures.top, resolution * 1, resolution * 0);\n    ctx.drawImage(textures.bottom, resolution * 1, resolution * 2);\n\n    function drawIndividual(source, targetId) {\n      var canvas = document.getElementById(targetId);\n      canvas.width = canvas.height = resolution;\n      var ctx = canvas.getContext('2d');\n      ctx.drawImage(source, 0, 0);\n    }\n\n    drawIndividual(textures.left, 'texture-left');\n    drawIndividual(textures.right, 'texture-right');\n    drawIndividual(textures.front, 'texture-front');\n    drawIndividual(textures.back, 'texture-back');\n    drawIndividual(textures.top, 'texture-top');\n    drawIndividual(textures.bottom, 'texture-bottom');\n  }\n\n  renderSpace() {\n    this.hideUnified();\n    this.hideSplit();\n\n    tick += 0.0025 * animationSpeed;\n\n\n    var view = glm.mat4.create();\n    var projection = glm.mat4.create();\n\n    renderCanvas.width = window.innerWidth;\n    renderCanvas.height = window.innerHeight;\n\n    glm.mat4.lookAt(view, [0, 0, 0], [Math.cos(tick), Math.sin(tick * 0.555), Math.sin(tick)], [0, 1, 0]);\n\n    glm.mat4.perspective(projection, fov, renderCanvas.width / renderCanvas.height, 0.1, 8);\n\n    skybox.render(view, projection);\n\n    requestAnimationFrame(this.renderSpace)\n  }\n/*\n            <a href=\"https://twitter.com/octaviauwu\" target=\"_blank\" rel=\"noopener noreferrer\"><img src={twitter} alt=\"Twitter Link\"></img></a>\n            <a href=\"https://www.twitch.tv/octayyvia\" target=\"_blank\" rel=\"noopener noreferrer\"><img src={twitch} alt=\"Twitch Link\"></img></a>\n            <a href=\"https://www.soundcloud.com/octaviauwu\" target=\"_blank\" rel=\"noopener noreferrer\"><img src={soundcloud} alt=\"SoundCloud Link\"></img></a>\n            <a href=\"https://www.youtube.com/channel/UCo5iJfS9rDGTNyZmSKKHy5w\" target=\"_blank\" rel=\"noopener noreferrer\"><img src={youtube} alt=\"YouTube Link\"></img></a>\n*/\n  render() {\n    return (\n      <div className=\"App\">\n        <div className=\"information\">\n          <p>OCTAVIA</p>\n          <div className=\"links\">\n          </div>\n        </div>\n        <div className=\"project-button\">\n          <a className=\"button\" href=\"https://www.github.com/octavia\" target=\"_blank\" rel=\"noopener noreferrer\">PROJECTS</a>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './app';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n"],"sourceRoot":""}